<PRINTTYPE TIME FIX>

<SETG RVEC [!"I !"V !"X !"L !"C !"D !"M "V_" "X_" "L_""C_" "D_" "M_"]>

<DEFINE RCPRINT (MODN R)
#DECL ((MODN) FIX (R) VECTOR)
<SET MODN <MOD .MODN 10>>
<COND (<==? 0 .MODN>)
(<==? 1 .MODN> <PRINC <1 .R>>)
(<==? 2 .MODN> <PRINC <1 .R>> <PRINC <1 .R>>)
(<==? 3 .MODN> <PRINC <1 .R>> <PRINC <1 .R>> <PRINC <1 .R>>)
(<==? 4 .MODN> <PRINC <1 .R>> <PRINC <2 .R>>)
(<==? 5 .MODN> <PRINC <2 .R>>)
(<==? 6 .MODN> <PRINC <2 .R>> <PRINC <1 .R>>)
(<==? 7 .MODN> <PRINC <2 .R>> <PRINC <1 .R>> <PRINC <1 .R>>)
(<==? 8 .MODN> <PRINC <2 .R>> <PRINC <1 .R>> <PRINC <1 .R>> <PRINC <1 .R>>)
(<==? 9 .MODN> <PRINC <1 .R>> <PRINC <3 .R>>)>>


<DEFINE ROMAN-PRINT RPACT (NUMB)
	#DECL ((NUMB) FIX)
	<COND	(<==? FLATSIZE <FUNCT <FRAME <CHTYPE .RPACT FRAME>>>> 0)
	 (<OR <==? .NUMB 0> <L? .NUMB 0> <G? .NUMB 3999999>>
		<PRINC <CHTYPE .NUMB TIME>>)
	(T
	<RCPRINT </ .NUMB 1000000> '%<REST ,RVEC 12>>
	<RCPRINT </ .NUMB 100000> '%<REST ,RVEC 10>>
	<RCPRINT </ .NUMB 10000> '%<REST ,RVEC 8>>
	<RCPRINT </ .NUMB 1000> '%<REST ,RVEC 6>>
	<RCPRINT </ .NUMB 100> '%<REST ,RVEC 4>>
	<RCPRINT </ .NUMB 10> '%<REST ,RVEC 2>>
	<RCPRINT .NUMB '%,RVEC>)>>

<DEFINE OCPRINT (MODN R)
#DECL ((MODN) FIX (R) VECTOR)
<SET MODN <MOD .MODN *10*>>
<COND (<==? 0 .MODN>)
(<==? 1 .MODN> <PRINC <1 .R>>)
(<==? 2 .MODN> <PRINC <1 .R>> <PRINC <1 .R>>)
(<==? 3 .MODN> <PRINC <1 .R>> <PRINC <2 .R>>)
(<==? 4 .MODN> <PRINC <2 .R>>)
(<==? 5 .MODN> <PRINC <2 .R>> <PRINC <1 .R>>)
(<==? 6 .MODN> <PRINC <2 .R>> <PRINC <1 .R>> <PRINC <1 .R>>)
(<==? 7 .MODN> <PRINC <1 .R>> <PRINC <3 .R>>)>>


<DEFINE OMAN-PRINT RPACT (THISONE "AUX" (NUMB <CHTYPE .THISONE FIX>))
	#DECL ((THISONE) <PRIMTYPE WORD> (NUMB) FIX)
	<COND	(<==? FLATSIZE <FUNCT <FRAME <CHTYPE .RPACT FRAME>>>> 0)
	 (<OR <==? .NUMB 0> <L? .NUMB 0> <G? .NUMB *2777777*>>
		<PUT .OUTCHAN 18 8>
		<PRINC !"#>
		<PRINC <TYPE .THISONE>>
		<PRINC " *">
		<PRINC <CHTYPE .NUMB TIME>>
		<PRINC !"*>
		<PUT .OUTCHAN 18 10>
		)
	(T
	<PRINC !"#>
	<PRINC <TYPE .THISONE>>
	<PRINC " *">
	<OCPRINT </ .NUMB *1000000*> '%<REST ,RVEC 12>>
	<OCPRINT </ .NUMB *100000*> '%<REST ,RVEC 10>>
	<OCPRINT </ .NUMB *10000*> '%<REST ,RVEC 8>>
	<OCPRINT </ .NUMB *1000*> '%<REST ,RVEC 6>>
	<OCPRINT </ .NUMB *100*> '%<REST ,RVEC 4>>
	<OCPRINT </ .NUMB *10*> '%<REST ,RVEC 2>>
	<OCPRINT .NUMB '%,RVEC>
	<PRINC !"*>)>>


<COND (<GASSIGNED? FILE-COMPILE>)(<PRINTTYPE FIX  ,ROMAN-PRINT>
<PRINTTYPE LOSE ,OMAN-PRINT>
<PRINTTYPE SUBR ,OMAN-PRINT>
<PRINTTYPE FSUBR ,OMAN-PRINT>
<PRINTTYPE WORD ,OMAN-PRINT>
<PRINTTYPE BITS ,OMAN-PRINT>

<REMOVE OMAN-PRINT>
<REMOVE OCPRINT>
<REMOVE ROMAN-PRINT >
<REMOVE RVEC>
<REMOVE RCPRINT>
<REMOVE R>
<REMOVE NUMB>
<REMOVE MODN>
)>