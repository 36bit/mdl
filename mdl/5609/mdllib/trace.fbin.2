'<PCODE "TRACE">

<PACKAGE "TRACE"> 

<ENTRY TRACE UNTRACE TFUNCTION TRSUBR TRSUBR-ENTRY TSUBR TRACELIST> 

<ENTRY INDENT INDENT-MOD IN-BREAK IN-PRINT OUT-BREAK OUT-PRINT VERBOSE TSTRUC> 

<ENTRY TRACE-ARGS TRACE-VAL> 

<NEWTYPE TFUNCTION LIST> 

<NEWTYPE TRSUBR VECTOR> 

<NEWTYPE TRSUBR-ENTRY VECTOR> 

<NEWTYPE TSUBR WORD> 

<NEWTYPE TSTRUC VECTOR '<<PRIMTYPE VECTOR> [7 ANY]>> 

<PUT APPTRACE DECL '<OR TFUNCTION TRSUBR TRSUBR-ENTRY TSUBR>> 

<SETG IN-BREAK 1> 

<SETG IN-PRINT 2> 

<SETG OUT-PRINT 3> 

<SETG OUT-BREAK 4> 

<SETG VERBOSE 5> 

<SETG NAME 6> 

<SETG RVAL 7> 

<MANIFEST IN-BREAK IN-PRINT OUT-PRINT OUT-BREAK VERBOSE NAME RVAL> 

<SETG TRACE  %<RSUBR!- '[ %<PCODE!- "TRACE" 0> TRACE #DECL ("VALUE" <OR ATOM 
FALSE <LIST [REST ATOM]>> "OPTIONAL" <OR FALSE ATOM <LIST [REST ATOM]>> "TUPLE" 
<TUPLE [REST <OR ATOM LIST>]>) ENTRY-HACK TRACE-IT T "MUDBUG;TRACE ORDER" 
"IN-BREAK" "OUT-BREAK" "VERBOSE" "IN-PRINT" "OUT-PRINT"]>> 
<AND <ASSIGNED? GLUE> .GLUE <PUT ,TRACE PGLUE ![738193408!]>> 


<SETG ENTRY-HACK  %<RSUBR!- '[ %<PCODE!- "TRACE" 253> ENTRY-HACK #DECL ("VALUE" 
FORM FORM) "TRACE-ARGS" TRACE-ARGS "TRACE-VAL" TRACE-VAL]>> 
<AND <ASSIGNED? GLUE> .GLUE <PUT ,ENTRY-HACK PGLUE ![1069547520!]>> 


<OR <GASSIGNED? TRACELIST> <SETG TRACELIST ()>> 

<GDECL (TRACELIST) <LIST [REST ATOM]>> 

<SETG TRACE-IT  %<RSUBR!- '[ %<PCODE!- "TRACE" 322> TRACE-IT #DECL ("VALUE" <OR 
ATOM FALSE> ATOM ANY ANY ANY ANY ANY) %<TYPE-C TFUNCTION LIST> %<TYPE-C TRSUBR 
VECTOR> %<TYPE-C TRSUBR-ENTRY VECTOR> %<TYPE-C TSUBR WORD> TRACE %<TYPE-W 
TFUNCTION LIST> %<TYPE-W TRSUBR VECTOR> %<TYPE-W TRSUBR-ENTRY VECTOR> %<TYPE-W 
TSUBR WORD> %<RGLOC TRACELIST T> %<TYPE-W TSTRUC VECTOR>]>> 
<AND <ASSIGNED? GLUE> .GLUE <PUT ,TRACE-IT PGLUE ![1073741568!]>> 


<SETG UNTRACE  %<RSUBR!- '[ %<PCODE!- "TRACE" 476> UNTRACE #DECL ("VALUE" <OR 
ATOM <LIST [REST ATOM]>> "OPTIONAL" <OR ATOM <LIST [REST ATOM]>>) UNTRACE-IT %<
RGLOC TRACELIST T> TRACE]>> 
<AND <ASSIGNED? GLUE> .GLUE <PUT ,UNTRACE PGLUE ![788529152!]>> 


<SETG UNTRACE-IT  %<RSUBR!- '[ %<PCODE!- "TRACE" 569> UNTRACE-IT #DECL ("VALUE" 
ANY ATOM) %<RGLOC TRACELIST T> TRACE T]>> 
<AND <ASSIGNED? GLUE> .GLUE <PUT ,UNTRACE-IT PGLUE ![1056964608!]>> 


<SETG TSTRUC-PRINT  %<RSUBR!- '[ %<PCODE!- "TRACE" 659> TSTRUC-PRINT #DECL (
"VALUE" ATOM TSTRUC) OUTCHAN "IN-BREAK:  " "IN-PRINT:  " "OUT-PRINT:  " 
"OUT-BREAK:  " "VERBOSE:  "]>> 
<AND <ASSIGNED? GLUE> .GLUE <PUT ,TSTRUC-PRINT PGLUE ![1073479680!]>> 


<PRINTTYPE TSTRUC ,TSTRUC-PRINT> 

<PRINTTYPE TRSUBR-ENTRY RSUBR-ENTRY> 

<PRINTTYPE TRSUBR RSUBR> 

<SETG INDENT-MOD 10> 

<GDECL (INDENT INDENT-MOD) FIX> 

<SETG TRACER  %<RSUBR!- '[ %<PCODE!- "TRACE" 769> TRACER #DECL ("VALUE" ANY 
APPTRACE "TUPLE" TUPLE) INDENT-TO &1 & TBREAK %<TYPE-W TSTRUC VECTOR> TRACE-ARGS
 (TUPLE) INDENT (<OR FIX FALSE>) TRACE-VAL (ANY) OUTCHAN %<RGLOC OUTCHAN T> (
CHANNEL) INDENT-MOD %<RGLOC INDENT-MOD T> TRACE "Entering " " with " "Leaving "
]>> 
<AND <ASSIGNED? GLUE> .GLUE <PUT ,TRACER PGLUE ![717225983 -67108864!]>> 


<SETG TBREAK  %<RSUBR!- '[ %<PCODE!- "TRACE" 1034> TBREAK #DECL ("VALUE" ANY ANY
) QUICK-RUN!-IEDIT T (ATOM) OUTCHAN "**BREAK**"]>> 
<AND <ASSIGNED? GLUE> .GLUE <PUT ,TBREAK PGLUE ![1072693248!]>> 


<APPLYTYPE TRSUBR ,TRACER> 

<APPLYTYPE TRSUBR-ENTRY ,TRACER> 

<APPLYTYPE TSUBR ,TRACER> 

<APPLYTYPE TFUNCTION ,TRACER> 

<ENDPACKAGE> 
