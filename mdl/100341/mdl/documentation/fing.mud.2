<USE "CHAOS">

<SETG HOST-VECTOR ["EE" "XX" "OZ" "MC" "AI" "ML" "MC" "DM"]>

<SETG USER-VECTOR ["CYPHER"
		   "FHSU"
		   "CWL"]>

<SETG INFO-VECTOR []>

<DEFINE CHECK ()	
  <MAPF <>
	<FUNCTION (HOST)
	  <MAPF <>
		<FUNCTION (NAME)
		  <COND (<NOT <SET HANDLE
				   <CHAOS-OPEN <STRING .HOST ".NAME_" .NAME>>>>
			 <MAPRET>)
			(ELSE
			 <CHAOS-RESP ,BUFFER .HANDLE>
			 <SETG INFO-VECTOR <VECTOR  ,BUFFER
						    !,INFO-VECTOR>>)>>
		,USER-VECTOR>>
	,HOST-VECTOR>>

<DEFINE RUN ()
  <REPEAT ()
    <SLEEP 10>
    <CHECK>
    <MAPF <>
	  <FUNCTION (ENTRY)
	    <PRINC .ENTRY>>
	  ,INFO-VECTOR>
    <AGAIN>>>