
<TITLE	PAGE-CLEAR>
	<DECLARE ("VALUE" 'T FIX FIX)>
	<DPUSH	TP* (AB)>
	<DPUSH	TP* 2(AB)>
	<PUSHJ	P* CPAGE>
	<JRST	FINIS>

<INTERNAL-ENTRY CPAGE 1>
	<SUBM	M* (P)>
	<MOVE	A* -2(TP)>
	<IMULI	A* 1024>
	<SETZM	(A)>
	<HRL	A* A>
	<AOJ	A*>
	<HLRZ	B* A>
	<MOVE	C* (TP)>
	<IMULI	C* 1024>
	<SUBI	C* 1>
	<ADD	B* C>
	<BLT	A* (B)>	
	<MOVE	A* <TYPE-WORD ATOM>>
	<MOVE	B* <MQUOTE T>>
	<SUB	TP* [<4 (4)>]>
	<JRST	MPOPJ>	

<TITLE	CLEAR-UV>
	<DECLARE ("VALUE" UVECTOR UVECTOR)>
 	<DPUSH	TP* (AB)>
	<PUSHJ	P* CUV>
	<JRST	FINIS>

<INTERNAL-ENTRY CUV 1>
	<SUBM	M* (P)>	
	<MOVE	A* (TP)>
	<SETZM	(A)>
	<HLRZ	B* A>
	<MOVNS	B>
	<SUBI	B* 1>
	<ADD	B* A>
	<HRL	A* A>
	<ADDI	A* 1>
	<BLT	A* (B)>
	<MOVE	A* -1(TP)>
	<MOVE	B* (TP)>
	<SUB	TP* [<2 (2)>]>
	<JRST	MPOPJ>

<TITLE AOBJECT>
	<DECLARE ("VALUE" UVECTOR ANY UVECTOR)>
	<DPUSH	TP* (AB)>
	<DPUSH	TP* 2(AB)>
	<PUSHJ	P* ALOC1>
	<JRST	FINIS>

<INTERNAL-ENTRY ALOC1 1>
	<SUBM	M* (P)>
	<MOVE	B* (TP)>
	<MOVE	A* -3(TP)>
	<MOVEM	A* (B)>
	<MOVE	A* -2(TP)>
	<MOVEM	A* 1(B)>
	<MOVE	A* -1(TP)>
	<SUB	TP* [<4 (4)>]>
	<JRST	MPOPJ>

<TITLE GET-VECTOR>
	<DECLARE ("VALUE" <OR FALSE VECTOR> <PRIMTYPE WORD>)>
	<DPUSH	TP* (AB)>
	<PUSHJ	P* GETVEC1>
	<JRST	FINIS>

<INTERNAL-ENTRY GETVEC1 1>
	<SUBM	M* (P)>
	<MOVE	A* <TYPE-WORD VECTOR>>
	<SKIPN	B* @ (TP)>
	<MOVE	A* <TYPE-WORD FALSE>>
	<SUB	TP* [<2 (2)>]>
	<JRST	MPOPJ>

<TITLE MOVE-M>
	<DECLARE ("VALUE" 'T <PRIMTYPE WORD> <PRIMTYPE WORD>)>
	<PUSH	TP* (AB)>
	<AOBJN	AB* HERE -1>
	<PUSHJ	P* MOVEM1>
	<JRST	FINIS>

<INTERNAL-ENTRY MOVEM1 2>
	<SUBM	M* (P)>
	<MOVE	A* -2(TP)>
	<MOVEM	A* @ (TP)>
	<MOVE	A* <TYPE-WORD ATOM>>
	<MOVE	B* <MQUOTE T>>
	<SUB	TP* [<4 (4)>]>
	<JRST	MPOPJ>

<TITLE GETLOC>
	<DECLARE ("VALUE" WORD <PRIMTYPE WORD>)>
	<DPUSH	TP* (AB)>
	<PUSHJ	P* GETLOC1>
	<JRST	FINIS>

<INTERNAL-ENTRY GETLOC1 1>
	<SUBM	M* (P)>
	<MOVE	A* <TYPE-WORD WORD>>
	<MOVE	B* @ (TP)>
	<SUB	TP* [<2 (2)>]>
	<JRST	MPOPJ>