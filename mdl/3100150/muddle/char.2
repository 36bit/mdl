CDIR==11

STEP==100'
XSIZ==7
YSIZ==9
XTTL==STEP*XSIZ*3/2
YTTL==STEP*0
XSPC==STEP*XSIZ*3/2
YSPC==STEP*YSIZ*7/4

MODLIN==0	;USED IN MACRO.

DEFINE CCC TYP,N,\CRS
	DEFINE FIN
CRS:	XTTL-XLST,,YLST-YTTL
	TERMIN
XLST==0
YLST==0
LIN==0
MOD==0
IFSE TYP,LIN,MOD==-2
IFSN N,,MOD==2

TYP!RR RCR,.-CRS+2+MOD(RPTM+IFSN TYP,LIN,[XQTM])
TERMIN

DEFINE LLL X,Y,I
	IFG MOD!I!LIN,LINRR RCR,-3(RPTM)
	STEP*X-XLST,,YLST-STEP*Y
XLST==STEP*X
YLST==STEP*Y
LIN==1
TERMIN

DEFINE FFF
	IFE MOD,SETPTR @0
	FIN
	TERMIN

ZZZZZZ==10
	RADIX 10.	;DECIMAL

UCA:	CCC POL,*
	LLL 0,9,*
	LLL 0,0
	LLL 7,0
	LLL 7,9
	LLL 0,5,*
	LLL 7,5
	FFF

UCB:	CCC POL
	LLL 0,4,*
	LLL 6,4
	LLL 7,3
	LLL 7,1
	LLL 6,0
	LLL 0,0
	LLL 0,9
	LLL 6,9
	LLL 7,8
	LLL 7,5
	LLL 6,4
	FFF

UCC:	CCC POL
	LLL 7,9,*
	LLL 0,9
	LLL 0,0
	LLL 7,0
	FFF

UCD:	CCC POL
	LLL 0,0 *
	LLL 0,9
	LLL 5,9
	LLL 7,7
	LLL 7,2
	LLL 5,0
	LLL 0,0
	FFF

UCE:	CCC POL,*
	LLL 7,9,*
	LLL 0,9
	LLL 0,0
	LLL 7,0
	LLL 0,4,*
	LLL 4,4
	FFF

UCF:	CCC POL,*
	LLL 0,9,*
	LLL 0,0
	LLL 7,0
	LLL 0,4,*
	LLL 5,4
	FFF

UCG:	CCC POL
	LLL 4,5,*
	LLL 7,5
	LLL 7,9
	LLL 0,9
	LLL 0,0
	LLL 7,0
	FFF

UCH:	CCC LIN
	LLL 0,0,*
	LLL 0,9
	LLL 0,5,*
	LLL 7,5
	LLL 7,9,*
	LLL 7,0
	FFF

UCI:	CCC LIN
	LLL 1,0,*
	LLL 5,0
	LLL 3,0,*
	LLL 3,9
	LLL 1,9,*
	LLL 5,9
	FFF

UCJ:	CCC POL,*
	LLL 0,7,*
	LLL 0,9
	LLL 5,9
	LLL 5,0
	LLL 3,0,*
	LLL 7,0
	FFF

UCK:	CCC LIN
	LLL 0,0,*
	LLL 0,9
	LLL 7,9,*
	LLL 2,4
	LLL 0,6,*
	LLL 6,0
	FFF

UCL:	CCC POL
	LLL 0,0,*
	LLL 0,9
	LLL 7,9
	FFF

UCM:	CCC POL
	LLL 0,9,*
	LLL 0,0
	LLL 7/2,4
	LLL 7,0
	LLL 7,9
	FFF

UCN:	CCC POL
	LLL 0,9,*
	LLL 0,0
	LLL 7,9
	LLL 7,0
	FFF

UCO:	CCC POL
	LLL 0,0,*
	LLL 7,0
	LLL 7,9
	LLL 0,9
	LLL 0,0
	FFF

UCP:	CCC POL
	LLL 0,9,*
	LLL 0,0
	LLL 7,0
	LLL 7,4
	LLL 0,4
	FFF

UCQ:	CCC POL
	LLL 4,6,*
	LLL 7,9
	LLL 0,9
	LLL 0,0
	LLL 7,0
	LLL 7,9
	FFF

UCR:	CCC POL
	LLL 0,9,*
	LLL 0,0
	LLL 7,0
	LLL 7,4
	LLL 0,4
	LLL 6,9
	FFF

UCS:	CCC POL
	LLL 0,9,*
	LLL 4,9
	LLL 7,6
	LLL 0,3
	LLL 3,0
	LLL 7,0
	FFF

UCT:	CCC LIN
	LLL 0,0,*
	LLL 7,0
	LLL 7/2,0,*
	LLL 7/2,9
	FFF

UCU:	CCC POL
	LLL 0,0,*
	LLL 0,9
	LLL 7,9
	LLL 7,0
	FFF

UCV:	CCC POL
	LLL 0,0,*
	LLL 7/2,9
	LLL 7,0
	FFF

UCW:	CCC POL
	LLL 0,0,*
	LLL 2,9
	LLL 7/2,4
	LLL 5,9
	LLL 7,0
	FFF

UCX:	CCC LIN
	LLL 0,0,*
	LLL 7,9
	LLL 0,9,*
	LLL 7,0
	FFF

UCY:	CCC POL,*
	LLL 0,0,*
	LLL 7/2,4
	LLL 7/2,9
	LLL 7/2,4,*
	LLL 7,0
	FFF

UCZ:	CCC POL
	LLL 0,0,*
	LLL 7,0
	LLL 0,9
	LLL 7,9
	FFF

; LOWER CASE LETTERS FOR E&S

LCA:	CCC POL
	LLL 1,3,*
	LLL 6,3
	LLL 6,9
	LLL 1,9
	LLL 1,6
	LLL 6,6
	FFF

LCB:	CCC POL
	LLL 1,0,*
	LLL 1,9
	LLL 6,9
	LLL 6,4
	LLL 1,4
	FFF

LCC:	CCC POL
	LLL 6,4,*
	LLL 1,4
	LLL 1,9
	LLL 6,9
	FFF

LCD:	CCC POL
	LLL 6,0,*
	LLL 6,9
	LLL 1,9
	LLL 1,4
	LLL 6,4
	FFF

LCE:	CCC POL
	LLL 1,6,*
	LLL 6,6
	LLL 6,4
	LLL 1,4
	LLL 1,9
	LLL 6,9
	FFF

LCF:	CCC POL,*
	LLL 4,0,*
	LLL 2,0
	LLL 2,9
	LLL 1,5,*
	LLL 3,5
	FFF

LCG:	CCC POL
	LLL 6,17/2,*
	LLL 1,17/2
	LLL 1,4
	LLL 6,4
	LLL 6,12
	LLL 1,12
	FFF

LCH:	CCC POL,*
	LLL 1,4,*
	LLL 6,4
	LLL 6,9
	LLL 1,9,*
	LLL 1,0
	FFF

LCI:	CCC LIN
	LLL 3,4,*
	LLL 3,9
	FFF

LCJ:	CCC POL
	LLL 5,4,*
	LLL 5,12
	LLL 2,12
	LLL 2,21/2
	FFF

LCK:	CCC POL,*
	LLL 6,3,*
	LLL 1,11/2
	LLL 6,9
	LLL 1,9,*
	LLL 1,0
	FFF

LCL:	CCC LIN
	LLL 2,0,*
	LLL 2,9
	FFF

LCM:	CCC POL,*
	LLL 1,9,*
	LLL 1,4
	LLL 6,4
	LLL 6,9
	LLL 7/2,17/2,*
	LLL 7/2,4
	FFF

LCN:	CCC POL,*
	LLL 6,9,*
	LLL 6,4
	LLL 1,9/2
	LLL 1,7/2,*
	LLL 1,9
	FFF

LCO:	CCC POL
	LLL 6,9,*
	LLL 6,4
	LLL 1,4
	LLL 1,9
	LLL 6,9
	FFF

LCP:	CCC POL
	LLL 1,9,*
	LLL 6,9
	LLL 6,4
	LLL 1,4
	LLL 1,12
	FFF

LCQ:	CCC POL
	LLL 6,12,*
	LLL 6,4
	LLL 1,4
	LLL 1,9
	LLL 6,9
	FFF

LCR:	CCC LIN
	LLL 6,4,*
	LLL 0,9/2
	LLL 1,7/2,*
	LLL 1,9
	FFF

LCS:	CCC POL
	LLL 6,4,*
	LLL 1,4
	LLL 1,13/2
	LLL 6,13/2
	LLL 6,9
	LLL 1,9
	FFF

LCT:	CCC LIN
	LLL 3,9,*
	LLL 3,0
	LLL 3/2,4,*
	LLL 9/2,4
	FFF

LCU:	CCC POL
	LLL 1,4,*
	LLL 1,9
	LLL 6,9
	LLL 6,4
	FFF

LCV:	CCC POL
	LLL 1,4,*
	LLL 7/2,9
	LLL 6,4
	FFF

LCW:	CCC POL
	LLL 1,4,*
	LLL 2,9
	LLL 7/2,6
	LLL 5,9
	LLL 6,4
	FFF

LCX:	CCC LIN
	LLL 1,4,*
	LLL 6,9
	LLL 1,9,*
	LLL 6,4
	FFF

LCY:	CCC LIN
	LLL 1,4,*
	LLL 7/2,9
	LLL 2,12,*
	LLL 6,4
	FFF

LCZ:	CCC POL
	LLL 1,4,*
	LLL 6,4
	LLL 1,9
	LLL 6,9
	FFF

N0:	CCC POL
	LLL 0,9,*
	LLL 7,0
	LLL 7,9
	LLL 0,9
	LLL 0,0
	LLL 7,0
	FFF

N1:	CCC LIN
	LLL 3,0,*
	LLL 3,9
	LLL 1,9,*
	LLL 5,9
	FFF

N2:	CCC POL
	LLL 0,0,*
	LLL 7,0
	LLL 7,3
	LLL 0,9
	LLL 7,9
	FFF

N3:	CCC POL
	LLL 0,0,*
	LLL 7,0
	LLL 3,4
	LLL 7,7
	LLL 5,9
	LLL 0,9
	FFF

N4:	CCC POL
	LLL 5,9,*
	LLL 5,0
	LLL 0,5
	LLL 7,5
	FFF

N5:	CCC POL
	LLL 7,0,*
	LLL 0,0
	LLL 0,4
	LLL 7,4
	LLL 7,7
	LLL 5,9
	LLL 0,9
	FFF

N6:	CCC POL
	LLL 1,4,*
	LLL 6,6
	LLL 6,9
	LLL 0,9
	LLL 0,6
	LLL 4,-2
	FFF

N7:	CCC POL
	LLL 0,0,*
	LLL 7,0
	LLL 3,9
	FFF

N8:	CCC POL
	LLL 7,0,*
	LLL 0,9
	LLL 4,9
	LLL 7,6
	LLL 0,3
	LLL 3,0
	LLL 7,0
	FFF

N9:	CCC POL
	LLL 6,5,*
	LLL 1,3
	LLL 1,0
	LLL 7,0
	LLL 7,3
	LLL 3,11
	FFF

XCL:	CCC LIN
	LLL 3,0,*
	LLL 3,6
	LLL 3,8,*
	LLL 3,9
	FFF

QT2:	CCC LIN
	LLL 2,0,*
	LLL 2,2
	LLL 5,2,*
	LLL 5,0
	FFF

NUM:	CCC LIN
	LLL 2,0,*
	LLL 2,9
	LLL 0,6,*
	LLL 7,6
	LLL 5,9,*
	LLL 5,0
	LLL 7,3,*
	LLL 0,3
	FFF

DOL:	CCC POL,*
	LLL 0,9,*
	LLL 4,9
	LLL 7,6
	LLL 0,3
	LLL 3,0
	LLL 7,0
	LLL 7/2,-1,*
	LLL 7/2,10
	FFF

PCT:	CCC LIN
	LLL 0,0,*
	LLL 0,2
	LLL 7,0,*
	LLL 0,9
	LLL 7,9,*
	LLL 7,7
	FFF

AMP:	CCC POL
	LLL 7,10,*
	LLL 0,3
	LLL 0,0
	LLL 4,0
	LLL 4,3
	LLL 0,7
	LLL 0,9
	LLL 7,9
	FFF

LPR:	CCC POL
	LLL 6,0,*
	LLL 4,2
	LLL 4,7
	LLL 6,9
	FFF

RPR:	CCC POL
	LLL 1,0,*
	LLL 3,2
	LLL 3,7
	LLL 1,9
	FFF

LBK:	CCC POL
	LLL 6,0,*
	LLL 4,0
	LLL 4,9
	LLL 6,9
	FFF

RBK:	CCC POL
	LLL 1,0,*
	LLL 3,0
	LLL 3,9
	LLL 1,9
	FFF

COL:	CCC LIN
	LLL 2,3,*
	LLL 4,3
	LLL 2,8,*
	LLL 4,8
	FFF

PER:	CCC LIN
	LLL 2,8,*
	LLL 4,8
	FFF

MIN:	CCC LIN
	LLL 1,5,*
	LLL 6,5
	FFF

SEM:	CCC LIN
	LLL 2,3,*
	LLL 4,3
	LLL 4,7,*
	LLL 2,10
	FFF

COM:	CCC LIN
	LLL 4,7,*
	LLL 2,10
	FFF

EQL:	CCC LIN
	LLL 0,3,*
	LLL 7,3
	LLL 7,7,*
	LLL 0,7
	FFF

PLS:	CCC LIN
	LLL 1,5,*
	LLL 7,5
	LLL 4,2,*
	LLL 4,8
	FFF

GRT:	CCC POL
	LLL 0,0,*
	LLL 5,9/2
	LLL 0,9
	FFF

LES:	CCC POL
	LLL 7,0,*
	LLL 2,9/2
	LLL 7,9
	FFF

SLS:	CCC LIN
	LLL 7,0,*
	LLL 0,9
	FFF

BKS:	CCC LIN
	LLL 0,0,*
	LLL 7,9
	FFF

VRT:	CCC LIN
	LLL 7/2,0,*
	LLL 7/2,9
	FFF

UND:	CCC LIN
	LLL 0,11,*
	LLL 7,11
	FFF

QES:	CCC POL,*
	LLL 0,0,*
	LLL 7,0
	LLL 7,2
	LLL 3,6
	LLL 2,8,*
	LLL 4,8
	FFF

AT:	CCC POL
	LLL 0,9,*
	LLL 0,0
	LLL 7,0
	LLL 7,9
	LLL 2,9
	LLL 2,5
	LLL 5,5
	LLL 5,9
	FFF

AST:	CCC LIN
	LLL 0,4,*
	LLL 7,4
	LLL 5,1,*
	LLL 2,7
	LLL 5,7,*
	LLL 2,1
	FFF

QT1:	CCC LIN
	LLL 3,0 *
	LLL 2,3
	FFF

;	THIS IS THE BLINKER/POINTER

PNT:	JIF @[PEEL](PF0)	;FLAG COMPLEMENTED FOR BLINKING
	LI RAR,.+1(XQTM+PEELM)	;DISPLAY FOR NOW
	CCC POL
	LLL -2,-3,*
	LLL 3,-3
	LLL -7,-3
	LLL -2,-3
	LLL -2,12
	LLL -2,-3
	LLL -2,12
	LLL 3,12
	LLL -7,12
	LLL -2,12
XLST==XLST+XTTL
YLST==YLST+YTTL	;FUDGE SO "FIN" MAKES NO OFFSET
	FFF

CTL:	JIF [PEEL](PF0)	;FLAG COMP CONTROL BOX
	LI RAR,.+1(XQTM+PEELM)
	CCC POL
	LLL -2,-2,*
	LLL -2,11
	LLL 9,11
	LLL 9,-2
	LLL -2,-2
XLST==XLST+XTTL
YLST==YLST+YTTL
	FFF

ALT:	LIF RAR,ESTABL+" (PF0)	;ALTERNATE BETWEEN SPACE
	LIF RAR,@ESTABL+"$(PF0)	;AND DOLLAR
	NOP (PEELM+XQTM)	;GO DO, PEEL AFTER

	RADIX ZZZZZZ

ESSIZX:	XSPC
ESSIZY:	YSPC

WINDOW==XSPC*72.	;NUMBER OF CHARS

ESWIND:	0,,0	;LB WINDOW
	WINDOW,,WINDOW	;RT WINDOW, REF BY CR, FF

CR:	STCL WINDLB,WST(1)
	JMPPSH STOREL
	LOCLA CDIR,CSY(1)
RTCDIR: SETPTA WST
	RTCLA CDIR,(4)
	PEEL
WST:0	;WINDOW STORED IN CR,FF
CSY: 3,,0
CSX: 5,,0
STOREL: SKCL INSTLB,(4)
	LOCLSA INST,ESWIND(1)
	PEEL

FF:	STCL WINDRT,WST(1)
	JMPPSH STOREL
	LOCLA CDIR,CSX(1)
	JMP RTCDIR

DEFINE TBL A
	IRP X,,[A]
	LI RAR,X(XQTM)
	TERMIN
	TERMIN

DEFINE TBC B,A
	IRPC X,,A
	LI RAR,B!!X(XQTM)
	TERMIN
	TERMIN

ESTABL:	REPEAT 8,NOP
	SETPTR [-XTTL,,-YTTL]	;10 BS
	SETPTR [XTTL*3,,YTTL*3]	;11 TAB=3*SPC
	SETPTR [0,,-YSPC]	;12 LF
	SETPTR [0,,-YSPC*3]	;13 VT=3*LF
	JMPPSH FF	;14 FF
	JMPPSH CR	;15 CR
	REPEAT ESTABL-.+33,NOP	;16-32
	JMPPSH ALT	;ALTMODE 33
	REPEAT ESTABL-.+40,NOP	;34-37
	SETPTR [XTTL,,YTTL]	;40 SPC
	TBL [XCL,QT2,NUM,DOL,PCT,AMP,QT1]	;41-47
	TBL [LPR,RPR,AST,PLS,COM,MIN,PER,SLS]	;50-57
	TBC N,[0123456789]	;60-71
	TBL [COL,SEM,LES,EQL,GRT,QES,AT]	;72-100
	TBC UC,[ABCDEFGHIJKLMNOPQRSTUVWXYZ]	;UPPER CASE, 101-132
	TBL [LBK,BKS,RBK,VRT,UND,QT1]	;133-140
	TBC LC,[ABCDEFGHIJKLMNOPQRSTUVWXYZ]	;LOWER CASE,141-172
	TBL [LBK,BKS,RBK,VRT,UND]	;173-177

	IFN .-ESTABL-200,[PRINTC "ASCII TABLE NOT 200' LONG.
"]
	JMPPSH PNT	;EXTRA ENTRIES HERE. BLINKER CODE 200
	JMPPSH CTL	;CONTROL BOX, CODE 201

1,9
	FFF

LCT:	CCC LIN
	LLL 3,9,*
	LLL 3,0
	LLL 3/2,4,*
	LLL 9/2,4
	FFF

LCU:	CCC POL
	LLL 1,4,*
	LLL 1,9
	LLL 6,9
	LLL 6,4
	FFF

LCV:	CCC POL
	LLL 1,4,*
	LLL 7/2,9
	LLL 6,4
	FFF

LCW:	CCC POL
	LLL 1,4,*
	LLL 2,9
	LLL 7/2,6
	LLL 5,9
	LLL 6,4
	FFF

LCX:	CCC LIN
	LLL 1,4,*
	LLL 6,9
	LLL 1,9,*
	LLL 6,4
	FFF

LCY:	CCC LIN
	LLL 1,4,*
	LLL 7/2,9
	LLL 2,12,*
	LLL 6,4
	FFF

LCZ:	CCC POL
	LLL 1,4,*
	LLL 6,4
	LLL 1,9
	LLL 6,9
	FFF

N0:	CCC POL
	LLL 0,9,*
	LLL 7,0
	LLL 7,9
	LLL 0,9
	LLL 0,0
	LLL 7,0
	FFF

N1:	CCC LIN
	LLL 3,0,*
	LLL 3,9
	LLL 1,9,*
	LLL 5,9
	FFF

N2:	CCC POL
	LLL 0,0,*
	LLL 7,0
	LLL 7,3
	LLL 0,9
	LLL 7,9
	FFF

N3:	CCC POL
	LLL 0,0,*
	LLL 7,0
	LLL 3,4
	LLL 7,7
	LLL 5,9
	LLL 0,9
	FFF

N4:	CCC POL
	LLL 5,9,*
	LLL 5,0
	LLL 0,5
	LLL 7,5
	FFF

N5:	CCC POL
	LLL 7,0,*
	LLL 0,0
	LLL 0,4
	LLL 7,4
	LLL 7,7
	LLL 5,9
	LLL 0,9
	FFF

N6:	CCC POL
	LLL 1,4,*
	LLL 6,6
	LLL 6,9
	LLL 0,9
	LLL 0,6
	LLL 4,-2
	FFF

N7:	CCC POL
	LLL 0,0,*
	LL