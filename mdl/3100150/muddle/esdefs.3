PRINTC / ESDEFS	P. HUGHETT	6 JAN 71	RVSD 24 Feb 71
/
;
;
; NEW DEFINITION OF INSTRUCTIONS FOR THE ESCC DISPLAY SYSTEM
; FOR 101129-101 TYPE CHANNEL CONTROLS INCLUDING ALL DEVICES.	
; REGISTER NAMES ARE DEFINED AS CONSTANTS WITH ==, SO THAT THEY
; WILL NOT BE TYPED OUT BY DDT, BUT MAY BE TYPED IN.
;
; INSTRUCTIONS ARE DEFINED WITH SINGLE =.
;
;
;		--- REVISIONS ---


;  22 JAN 71:  CORRECTED THE VALUES FOR THE LITS, LOMDIR,
;	STMDIR,RTMDIR, AND SKMDIR SYMBOLS.  ALSO ADDED
;	NAMELB FOR COMPATIBILITY WITH OLD PROGS.  THIS BECOME
;	VERSION 3.1.  -PWH

;  16 FEB 71:  Version 3.2 adds definitions for the LIS and RJMP
;	instructions.  -PWH

;  23 FEB 71:  Version 3.3 changes the values of JMOC, KMOC,
;	JMOM,KMOM,TM3,TM2,TM1, and TM0 to conform to Fig. 3.8
;	of the E&S Reference Manual (1 Nov 70) rather than to
;	Appendix II.  -PWH
;	THE CHANNEL CONTROL REGISTERS:
RAR==0
WAR==1
PC==2
SP==3
P1==4
P2==5
DSP==6
UR==7
RCR==10
WCR==11
DIR==12
RSR==13
SR==14
NEXT==17
;
;	THE NEXT-MODE'S :
XQTM==10
RPTM==4
PEELM==2
PROGM==1
;
;	CONDITIONS WHICH MAY BE CHECKED :
PF0==0		; PROGRAM FLAG #0
PF1==1		; PROGRAM FLAG #1
PF2==2		; PROGRAM FLAG #2
PF3==3		; PROGRAM FLAG #3
PF4==4		; PROGRAM FLAG #4
PF5==5		; PROGRAM FLAG #5
PF6==6		; PROGRAM FLAG #6
PF7==7		; PROGRAM FLAG #7
RCRN==10	; RCR LESS THAN -1
WCRN==11	; WCR LESS THAN -1
HITF==12	; HIT FLAG
AICF==13	; AREA IN COMMON FLAG
PF14==14	; PROGRAM FLAG #14
PF15==15	; PROGRAM FLAG #15
PF16==16	; PROGRAM FLAG #16
STOPF==17	; STOP FLAG
;
;	THE CLIPPER-DIVIDER REGISTERS :
SAVELB==0	; TWO COMPONENTS
SAVERT==1	; TWO COMPONENTS
VIEWLB==2	; TWO COMPONENTS
VIEWRT==3	; TWO COMPONENTS
WINDLB==4	; TWO COMPONENTS
WINDRT==5	; TWO COMPONENTS
INSTLB==6	; TWO COMPONENTS
INSTRT==7	; TWO COMPONENTS
NAME==10	; TWO COMPONENTS
NAMELB==NAME	;  (FOR OLD PROGS)
CDIR==11	; TWO COMPONENTS
HITANG==12	; TWO COMPONENTS
SELINT==13	; TWO COMPONENTS
;
SAVE==14	; FOUR COMPONENTS
VIEW==15	; FOUR COMPONENTS
WIND==16	; FOUR COMPONENTS
INST==17	; FOUR COMPONENTS
;
;
;	CHARACTER BUBBLE REGISTERS
FONT==1
CHAR==0
;
;
;	SBKL REGISTERS
LITS==6
SWCH==4
;
;
;		--- DIRECTIVE BITS ---


;		-- DIR --

JMMA==100000		;SET MATRIX MULTIPLIER ACTIVE
KMMA==40000		;RESET MMA
JNO==20000		;SET NO OVERLAP
KNO==10000		;RESET NO OVERLAP
J3D==4000		;SET 3D MODE
K3D==2000		;RESET 3D
JDT==1000		;SET DO TWICE
KDT==400		;..RESET
JSOH==10		;SET STOP ON HIT
KSOH==4			;..RESET
JSOWCR==2		;SET STOP ON WCR POSITIVE
KSOWCR==1		;..RESET


;		-- CDIR --

STOS==(100000)		;SCALED TO SCOPE
STOM==(40000)		;SCALED TO MEMORY
ZTOS==(20000)		;Z TO SCOPE
PTOM==(10000)		;CLIPPED PAGE TO MEMORY
NTOM==(4000)		;NAME TO MEMORY
TTO==(2000)		;TAKE "TO" BITS
JCURVE==(1000)		;SET CURVE MODE
KCURVE==(400)		;..RESET
JMEF==(200)		;SET MINIMUM EFFORT MODE
KMEF==(100)		;..RESET
JDL==(40)		;SET DOTTED LINE MODE
KDL==(20)		;..RESET
SELFX==(4)		;TAKE X DATA FROM INST
SELFY==(2)		;TAKE Y DATA FROM INST
TSELF==(1)		;TAKE "SELF" BITS

;		-- MDIR --

JMOC==(1000)		;SET MATRIX OUTPUT TO CLIPPER
KMOC==(400)		;..RESET
JMOM==(200)		;SET MATRIX OUTPUT TO MEMORY
KMOM==(100)		;..RESET
TM3==(70)		;SET TRANSPOSE MODE 3
TM2==(60)		;..MODE 2
TM1==(50)		;..MODE 1
TM0==(40)		;..MODE 0
JMCUR==(4)		;SET MM CURVE MODE
KMCUR==(2)		;..RESET
TAKEQ==(1)		;TAKE Q VALUE
; GROUP 0 - LOAD IMMEDIATE INSTRUCTIONS
;
LI=000000000000		; LOAD IMMEDIATE
LIS=(020000)	; LOAD IMMEDIATE AND STUFF
LIPSH=040000000000	; LOAD IMM. PSH-OLD-VALUE
LIPSHM=060000000000	; LOAD IMM. PSH-OLD-VALUE MARKED
PSH=LIPSH ,@0	; PSH-OLD-VALUE, WITHOUT LOAD
PSHM=LIPSHM ,@0	; PSH-OLD-VALUE MARKED, WITHOUT LOADING
NOP=LI ,@0
JMP=LI PC,0	; NOTE: JMP FOR DISPLAY, JUMP FOR 10
JMPPSH=LIPSHM PC,0	; A MARKED [JMP 0] IS SAVED IN STACK
RJMP=LIS PC,0	;JUMP AND STUFF RAR
NWSTK=LIPSH SP,0 ; UNMARKED [LI SP,0] IS SAVED IN STACK
NWSTKM=LIPSHM SP,0	; A MARKED [LI SP,0] IS SAVED IN STACK
XQTA=LI RAR,(XQTM); XQT THE INSTRUCTION IN E
XQT=NOP ,(XQTM)	; ENTQR SQT MODE
RPT=NOP ,(RPTM)	; ENTER RPT MODE
PEEL=NOP ,(PEELM)	; ENTER PEEL MODE
PROG=NOP ,(PROGM)	; ENTER PROG MODE
;
;
; GROUP 2 - CONDITIONAL LOAD IMMEDIATE
;
LIF=200000000000 ; LI IF CONDITION HOLDS
LIFCL=210000000000	; LIF AND CLEAR
LIFST=220000000000	; LIF AND SET
LIFCM=230000000000	; LIF AND COMPLEMENT
;
LAL=240000000000 ; LI ALWAYS, LAL IS SLOWER THAN LI
LALCL=250000000000	; LAL AND CLEAR
LALST=260000000000	; LAL AND SET
LALCM=270000000000	; LAL AND COMPLEMENT
;
JIF=LIF PC,	; JMP IF CONDITION HOLDS
JIFCL=LIFCL PC,	; JIF AND CLEAR
JIFST=LIFST PC,	; JIF AND SET
JIFCM=LIFCM PC,	; JIF AND COMPLEMENT
;
JAL=LAL PC,	; JMP ALWAYS, JAL IS SLOWER THAN JMP
JALCL=LALCL PC,	; JAL AND CLEAR
JALST=LALST PC,	; JAL AND SET
JALCM=LALCM PC,	; JAL AND COMPLEMENT
;
JIFDED=JIF ,(STOPF)	; JMP IF STOPPED
IJNRCR=JIFST ,(RCRN)	; INCREMENT RCR, JMP IF NEGATIVE
IJNWCR=JIFST ,(WCRN)	; INCREMENT WCR, JMP IF NEGATIVE
IJPRCR=IJNRCR ,@0	; INCREMENT RCR, JMP IF POSITIVE
IJPWCR=IJNWCR ,@0	; INCREMENT WCR, JMP IF POSITIVE
CL=LALCL ,@0	; CLEAR CONDITION
ST=LALST ,@0	; SET CONDITION
CM=LALCM ,@0	; COMPLEMENT CONDITION
STOP=ST (STOPF)
;

;
;
; GROUP 3 - EXTERNAL REGISTER TRANSMISSION
;
;
; CLIPPER--DEV 00XX--
LOCLA=300000000000	; LOAD CLIPPER ABSOLUTE
LOCLR=301000000000	; LOAD CLIPPER RELATIVE
LOCLSA=302000000000	; LOAD CLIPPER SIZE ABSOLUTE
LOCLSR=303000000000	; LOAD CLIPPER SIZE RELATIVE
STCL=320000000000	; STORE CLIPPER ABSOLUTE
RTCLA=340020000000	; RETREIVE CLIPPER ABSOLUTE
RTCLR=341020000000	; RETREIVE CLIPPER RELATIVE
RTCLSA=342020000000	; RETREIVE CLIPPER SIZE ABSOLUTE
RTCLSR=343020000000	; RETREIVE CLIPPER SIZE RELATIVE
SKCL=360020000000	; SINK CLIPPER ABSOLUTE
;
;
; MATRIX MULTIPLIER -- DEVICE 01XX --
LOMM=304000000000	; LOAD MATRIX MULTIPLIER
LOMMR=305000000000	; LOAD MATRIX MULTIPLIER RELATIVE
LOMMP=306000000000	; LOAD MATRIX MULTIPLIER PRODUCT
LOMDIR=(307001)	; LOAD MATRIX DIRECTIVE
STMM=324000000000	; STORE MATRIX MULTIPLIER
NOMM=325020000000	; NORMALIZE MATRIX MULTIPLIER (MATRIX A)
POPMM=326020000000	; POP MATRIX MULTIPLIER (INTO MATRIX A)
STMDIR=(327001)	; STORE MATRIX DIRECTIVE
RTMM=344020000000	; RETRIEVE MATRIX MULTIPLIER
RTMMS=345020000000	; RETRIEVE MATRIX MULTIPLIER & SLIDE
RTMDIR=(347021)	; RETRIEVE MATRIX DIRECTIVE
SKMM=364020000000	; SINK MATRIX MULTIPLIER
SKMMS=365020000000	; SINK MATRIX MULTIPLIER AND SLIDE
PUSHMM=366020000000	; PUSH MATRIX MULTIPLIER (FROM MATRIX A)
SKMDIR=(367021)	; SINK MATRIX DIRECTIVE
;
;
; CHARACTER BUBBLE -- DEVICE 1101 --
LOCB=315000000000
STCB=335000000000
RTCB=355020000000
SKCB=375020000000
;
;
; SBKL -- DEVICE 1111 --
LOSBKL=317000000000
STSBKL=337000000000
RTSBKL=357020000000
SKSBKL=377020000000
LOLITS=LOSBKL LITS,0(1)
STSWCH=STSBKL SWCH,0(1)
;
;
;
;
;
; GROUP 4-7 - DISPLAY INSTRUCTIONS
;
DD==400000000000 ; DO DIRECT
DI==500000000000 ; DO INDIRECT
DN==600000000000 ; DO INTERNAL
;
;	THE WHAT-TO-DO MACHINE :
;
LS==060000000000 ; LINES=(SET-DRAWTO)**
LT==070000000000 ; ?=(DRAWTO-SET)**
PO==030000000000 ; POLYG=SET-(DRAWTO)**
TO==020000000000 ; TO=(DRAWTO)**
SS==040000000000 ; STAR=SET-(DRAWFROM)**
FR==050000000000 ; FROM=(DRAWFROM)**
DT==010000000000 ; DOTS=(DOT)**
BX==000000000000 ; BOXES=(BOX)**
;
;	THE ABS/REL-MODES MACHINE :
;
RX==007000000000 ; (REL-ABS)**
AX==006000000000 ; (ABS-REL)**
RA==003000000000 ; REL-(ABS)**
AB==002000000000 ; (ABS)**
AR==004000000000 ; ABS-(REL)**
RE==005000000000 ; (REL)**
SL==001000000000 ; (SIZE REL)**
SA==000000000000 ; (SIZE ABS)**
;
;
;
;
;
;	COMMON DISPLAY INSTRUCTIONS:
SETPTA=DD+LS+AB	; SET-POINT-ABSOLUTE
SETPTR=DD+LS+RE	; SET-POINT-RELATIVE
DRAWTA=DD+TO+AB	; DRAW-TO-ABSOLUTE
DRAWTR=DD+TO+RE	; DRAW-TO-RELATIVE
DRAWFA=DD+FR+AB	; DRAW-FROM-ABSOLUTE
DRAWFR=DD+FR+RE	; DRAW-FROM-RELATIVE
LINAA=DD+LS+AB	; LINE-(ABSOLUTE-ABSOLUTE)
LINAR=DD+LS+AX	; LINE-(ABSOLUTE-RELATIVE)
LINRA=DD+LS+RX	; LINE-(RELATIVE-ABSOLUTE)
LINRR=DD+LS+RE	; LINE-(RELATIVE-RELATIVE)
LINIAA=DI+LS+AB	; LINE-INDIRECT-(ABSOLUTE-ABSOLUTE)
LINIAR=DI+LS+AX	; LINE-INDIRECT-(ABSOLUTE-RELATIVE)
LINIRA=DI+LS+RX	; LINE-INDIRECT-(RELATIVE-ABSOLUTE)
LINIRR=DI+LS+RE	; LINE-INDIRECT-(RELATIVE-RELATIVE)
POLAA=DD+PO+AB	; POLYGON-ABSOLUTE'S
POLAR=DD+PO+AR	; POLYGON-ABSOLUTE-RELATIVE'S
POLRR=DD+PO+RE	; POLYGON-RELATIVE'S
POLRA=DD+PO+RA	; POLYGON-RELATIVE-ABSOLUTE'S (?)
POLIAA=DI+PO+AB	; POLYGON-INDIRECT-(ABSOLUTE'S)
POLIAR=DI+PO+AR	; POLYGON-INDIRECT-(ABSOLUTE-RELATIVE'S)
POLIRR=DI+PO+RE	; POLYGON-INDIRECT-(RELATIVE'S)
POLIRA=DI+PO+RA	; POLYGON-INDIRECT-(RELATIVE-ABSOLUTE'S)
STARAA=DD+SS+AB	; STAR-ABSOLUTE'S
STARAR=DD+SS+AR	; STAR-ABSOLUTE-RELATIVE'S
STARRR=DD+SS+RE	; STAR-RELATIVE'S
STARRA=DD+SS+RA	; STAR-RELATIVE-ABSOLUTE'S(?)
DOTSAA=DD+DT+AB	; DOTS-ABSOLUTE'S
DOTSAR=DD+DT+AR	; DOTS-ABSOLUTE-RELATIVE'S
DOTSRR=DD+DT+RE	; DOTS-RELATIVE'S
DOTSRA=DD+DT+RA	; DOTS-RELATIVE-ABSOLUTE'S(?)
BOXA=DD+BX+AB	; BOX-ABSOLUTE
BOXR=DD+BX+RE	; BOX-RELATIVE
BOXSA=DD+BX+SA	; BOX-SIZE-ABSOLUTE
BOXSR=DD+BX+SL	; BOX-SIZE-RELATIVE
;
;	CURVE INSTRUCTIONS:
SETCRV=DN+LS+AB
DRACRV=DN+TO+AB
POLCRV=DN+PO+AB
DOTCRV=DN+DT+AB
NEWCRV=DN+BX+AB
FRMCRV=DN+SS+AB
;
;	CHARACTER INTERPRETATION INSTRUCTION:
DOCHAR=700000000000
;
; LI ALWAYS, LAL IS SLOWER THAN LI
LALCL=250000000000	; LAL AND CLEAR
LALST=260000000000	; LAL AND SET
LALCM=270000000000	; LAL AND COMPLEMENT
;
JIF=LIF PC,	; JMP IF CONDITION HOLDS
JIFCL=LIFCL PC,	; JIF AND CLEAR
JIFST=LIFST PC,	; JIF AND SET
JIFCM=LIFCM PC,	; JIF AND COMPLEMENT
;
JAL=LAL PC,	; JMP ALWAYS, JAL IS SLOWER THAN JMP
JALCL=LALCL PC,	; JAL AND CLEAR
JALST=LALST PC,	; JAL AND SET
JALCM=LALCM PC,	; JAL AND COMPLEMENT
;
JIFDED=JIF ,(STOPF)	; JMP IF STOPPED
IJNRCR=JIFST ,(RCRN)	; INCREMENT RCR, JMP IF NEGATIVE
IJNWCR=JIFST ,(WCRN)	; INCREMENT WCR, JMP IF NEGATIVE
IJPRCR=IJNRCR ,@0	; INCREMENT RCR, JMP IF POSITIVE
IJPWCR=IJNWCR ,@0	; INCREMENT WCR, JMP IF POSITIVE
CL=LALCL ,@0	; CLEAR CONDITION
ST=LALST ,@0	; SET CONDITION
CM=LALCM ,@0	; COMPLEMENT CONDITION
STOP=ST (STOPF)
;

;
;
; GROUP 3 - EXTERNAL REGISTER TRANSMISSION
;
;
; CLIPPER--DEV 00XX--
LOCLA=300000000000	; LOA