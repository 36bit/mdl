<MULTI-SECTION 3>
<SNAME "COMPIL">

<SETG TENEX? T>

<LINK '<ERRET T> "" <ROOT>>

<PACKAGE "CC" "ICC" 13 157>

<LINK OP!-PACKAGE!- "OP" <1 .OBLIST>>

<OR <ASSIGNED? PURE!-> <SET PURE!- T>>

<REMOVE MANIFEST?!->

<FLOAD "<COMPIL>BOPHAC.MUD">
<FLOAD "<COMPIL>MUDHAK.MUD">

<BEGIN-HACK "COMPIL">

<BEGIN-MHACK>

<ENDPACKAGE>

<BLOCK (<ROOT>)>

<SETG EXPERIMENTAL T>

IF

IRSUBR

ERRS

INCONS

WARNS

NOTES

CFC

IF-NOT

<SET TEMPLATE-DATA T>

USE-RGLOC!-

RGLOC!-

SNAME-SETTER!-

BATCH-COMPIL

<COND (<NOT <ASSIGNED? SILENT!->>
       <SET SILENT!- <>>)>

CONNECT-DIR

<ENDBLOCK>

<FLOAD "PS:<COMPIL>CONNECT-DIR.NBIN">

<BLOAT 100000 5000 100 1500 100>

<FLOAD "<COMPIL>NEWOP">

<SETG IAND!-OP!-PACKAGE `AND>

<SETG IANDI!-OP!-PACKAGE `ANDI>

<PROG ((GLUE <COND (<ASSIGNED? GLUE> .GLUE)>)) #DECL ((GLUE) <SPECIAL ANY>)
<FLOAD "<COMPIL>ASSEM.FBIN">>

<PACKAGE "CODING" "IC">

<FLOAD "<COMPIL>ATOSQ.NBIN">
<SETG ONLY-FAST-OUTPUT T>

<ENDPACKAGE>

<PACKAGE "CC" "ICC" 13 157>

<SETG L-NOISY <>>
<SETG L-NO-DEFER T>

<SETG NUMACS 5>

<USE "MACROS" "SORTX">

<USE "DOW">

<USE "DATIME">

<USE "TIMFCN">

<SETG IF ,AND!-><SETG IF-NOT ,OR!->	;"Abbreviations"

<LINK ASSEMBLE1!-CODING!-PACKAGE "ASSEMBLE1" <1 .OBLIST>>

<FLOAD "<COMPIL>WOFCH.FBIN">
<FLOAD "<COMPIL>POPWR2.FBIN">

<NEWTYPE TRANS VECTOR>

<NEWTYPE SAVED-STATE LIST>

<NEWTYPE ADDRESS:C LIST>

<NEWTYPE ADDRESS:PAIR LIST>

<NEWTYPE TYPED:ADDRESS LIST>

<NEWTYPE NODE VECTOR>

<NEWTYPE SYMTAB VECTOR>

<NEWTYPE IRSUBR LIST>

<NEWTYPE AC VECTOR>

<NEWTYPE DATUM LIST>

<NEWTYPE OFFPTR LIST>

<NEWTYPE TEMP VECTOR>

<SETG DEATH T>

<MAPF <>
      <FUNCTION (NM "AUX" CH)
		<COND (<G? <LENGTH .NM> 6> <SET NM <SUBSTRUC .NM 0 6>>)>
		<COND (<SET CH <OR <AND .PURE <OPEN "READ" .NM "FBIN" "DSK" "COMPIL">>
				   <OPEN "READ" <STRING .NM ".NBIN">>
				   <OPEN "READ" <STRING .NM ".BINARY">>
				   <OPEN "READ" .NM>>>
		       <LOAD .CH>
		       <CLOSE .CH>)
		      (ELSE <ERROR FILE-SYSTEM-ERROR!-ERRORS .CH>)>
		<COND (<NOT .SILENT!-> <PRINC .NM> <PRINC " ">)>>
      '["PASS1" "CHKDCL" "MAPPS1" "CUP" "MAPANA" "MAPGEN" "VARANA" "CARANA"
		"NEWREP" "CBACK" "COMSUB"
	"CARGEN" "CONFOR" "CDRIVE" "CPRINT" "COMTEM" "NOTANA" "NOTGEN" "STRANA"
	 "STRGEN"
        "ALLR" "LNQGEN" "MMQGEN" "ISTRUC" "INFCMP" "BITTST" "BITS" "BUILDL"
	"SPCGEN" "ADVMES" "CASE"
	"SYMANA" "CODGEN" "CACS"
	"COMCOD" "NPRINT"]>

<DEFINE DEBUGC!- ()
	<BLOCK (<1 .OBLIST> <GET ICC OBLIST><GET CC!-PACKAGE!- OBLIST> !<REST .OBLIST>)>
	T>

<PUT ,GENERATORS ,BACK-CODE ,BACK-GEN>

<PUT ,GENERATORS ,SUBSTRUC-CODE ,SUBSTRUC-GEN>

<PUT ,GENERATORS ,TOP-CODE ,TOP-GEN>

<PUT ,GENERATORS ,PUT-SAME-CODE ,SPEC-PUT-GEN>

<PUT ,GENERATORS ,COPY-LIST-CODE ,LIST-BUILD>

<PUT ,GENERATORS ,BIT-TEST-CODE ,BIT-TEST-GEN>
<PUT ,GENERATORS ,LSH-CODE ,LSH-GEN>
<PUT ,GENERATORS ,ROT-CODE ,ROT-GEN>

<PUT ,GENERATORS ,CASE-CODE ,CASE-GEN>
<PUT ,ANALYZERS ,CASE-CODE ,CASE-ANA>
<PUT ,CASE PAPPLY-OBJECT ,CASE-FCN>
<PUT ,ANALYZERS ,BIT-TEST-CODE ,BIT-TEST-ANA>
<PUT ,ANALYZERS ,LSH-CODE ,LSH-ANA>
<PUT ,ANALYZERS ,ROT-CODE ,ROT-ANA>
<PUT ,ANALYZERS ,COPY-LIST-CODE ,COPY-AN>

<DEFINE UNDEBUGC!- () <ENDBLOCK> T>

<MAPF <> <FUNCTION (ATM "AUX" (O <OBLIST? .ATM>)) <INSERT <REMOVE .ATM> .O>>
	'(LOGOUT ERROR ERRET QUIT COND AGAIN REP TAG REDEFINE VALRET T)>

<DEFINE DUMP-COMP!- (N
                   "OPTIONAL" (GCQ T) (SN <SNAME>)  UNM
		    "AUX" CH (SR <>))
	<COND (<ASSIGNED? READ-TABLE> <SET SR .READ-TABLE>)>
	<UNASSIGN <GUNASSIGN READ-TABLE>>
	<SETG OQ ,QUIT>
        <SNAME "">
        <COND (<=? <FSAVE .N .GCQ> "SAVED">
               <SNAME .SN>
	       <COND (.SR <SET READ-TABLE <SETG READ-TABLE .SR>>)>)
              (<AND <OR <=? <SET UNM <UNAME>> "CLR">
			<=? .UNM "BTB">
			<=? .UNM "BKD">
			<=? .UNM "LIM">
			<=? .UNM "TAA">>
		    <OR <=? <SET SN <SNAME>> "COMPIL">
			<=? .SN "MDL.COMP">>>
	       <MULTI-SECTION 7>
	       <BEGIN-HACK "COMPIL"><BEGIN-MHACK> <RSUBR-LINK <>>
	       <PRINC "` and | hacks enabled. Rsubr-Link <>"> <CRLF>)
	      (ELSE
	       <MULTI-SECTION 7>
	       <SET SN <SNAME>>
	       <COND (<SET CH <OPEN "READ" <COND (<OR <=? .UNM "COMBAT">
						      <=? .SN "COMBAT">>
						  "PLAN.PLAN.-2")
						 ("PCOMP.PLAN")>>>
		       <LOAD .CH>
		       <QUIT>)
		     (ELSE
		      <CRLF>)>)>
        <PRINC "MUDDLE COMPILER NOW READY.">
        <CRLF>
        T>

<FLOAD "<COMPIL>PEEPH.FBIN">

<FLOAD "<COMPIL>RHACK">

<INSERT <REMOVE COMPILE> <ROOT>>

<INSERT <REMOVE COMPILE-GROUP> <ROOT>>

<DEFINE C ("OPTIONAL" (N 0)) <PRT <REST .CODE:TOP .N>>>

<PRIN-SET>

<SET REDEFINE!- T>

<FLOAD "<COMPIL>A.Q">

<FLOAD "<COMPIL>PRIMHK.NBIN">

<FLOAD "<COMPIL>PRNTYP">

<SETG EXPERIMENTAL T>


<UNASSIGN <REMOVE REDEFINE!->>

<ENDPACKAGE>

<FLOAD "<COMPIL>COMP105.NCOMFI">

<PROG () ;<PRINC "Peep Hole optimizer enabled?">
	 <SET PEEP!-ICC!-CC!-PACKAGE T ;<ERROR>>
	 ;<CRLF>
	 ;<PRINC "KILL-COMP disabled">
	 ;<CRLF>
	 <SETG KILL-COMP!-CFC ,TIME>>

<FREEZE <IUVECTOR 1000>>

<BLOAT 30000 0 300 500>
