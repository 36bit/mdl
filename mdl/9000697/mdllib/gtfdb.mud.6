<PACKAGE "GTFDB">

<ENTRY GTFDB FDBBLK>

<ENTRY FBCTL FBPRT FBCRE FBAUT FBGEN FBACT FBBYV FBSIZ FBCRV FBWRT FBREF
       FBCNT FBBK0 FBBK1 FBBK2 FBBK3 FBBK4 FBUSW FBLWR>

<SETG FBCTL 2>
<SETG FBPRT 5>
<SETG FBCRE 6>
<SETG FBGEN 8>
<SETG FBACT 9>
<SETG FBBYV 10>
<SETG FBSIZ 11>
<SETG FBCRV 12>
<SETG FBWRT 13>
<SETG FBREF 14>
<SETG FBCNT 15>
<SETG FBBK0 16>
<SETG FBBK1 17>
<SETG FBBK2 18>
<SETG FBBK3 19>
<SETG FBBK4 20>
<SETG FBUSW 21>
<SETG FBLWR 25>
<SETG FBLEN 26>

<MANIFEST FBCTL FBPRT FBCRE FBAUT FBGEN FBACT FBBYV FBSIZ FBCRV FBWRT
	  FBREF FBCNT FBBK0 FBBK1 FBBK2 FBBK3 FBBK4 FBUSW FBLWR>

<SETG FDBBLK <IUVECTOR 25 #WORD 0>>
<GDECL (FDBBLK) <UVECTOR [REST WORD]>>

<DEFINE GTFDB (JFN "OPTIONAL" (ST 0))
	<DO-GTFDB .JFN <REST ,FDBBLK .ST>>>

<TITLE DO-GTFDB>
	<DECLARE ("VALUE" <OR UVECTOR FALSE> <PRIMTYPE WORD> UVECTOR)>
	<DPUSH TP* (AB)>
	<DPUSH TP* 2(AB)>
	<PUSHJ P* IGTFDB>
	<JRST FINIS>

<INTERNAL-ENTRY IGTFDB 2>
	<SUBM	M* (P)>
	<HRRZ	A* -2(TP)>
	<HLRO	B* (TP)>
	<ADDI	B* 25>
	<HLRO	C* (TP)>
	<MOVNS	C>
	<HRL	B* C>
	<HRRZ	C* (TP)>
	<GTFDB>
	 <ERJMP	IGTFAIL>
	<MOVE	A* -1(TP)>
	<MOVE	B* (TP)>
IGTRET	<SUB	TP* [<2(2)>]>
	<JRST	MPOPJ>

IGTFAIL	<MOVSI	A* <TYPE-CODE FALSE>>
	<MOVEI	B* 0>
	<JRST	IGTRET>
<END>

<ENDPACKAGE>