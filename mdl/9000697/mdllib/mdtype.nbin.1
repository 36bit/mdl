
<PACKAGE "MDTYPE"> 

<USE "TEMHLP"> 

<ENTRY DOT DASH ELT LTR WRD> 

<ENTRY MREST MBACK MTOP?> 

<ENTRY SRC RND ILLSPC SPCHNG> 

<ENTRY MCOD> 

<ENTRY EVNT EVTYP> 

<ENTRY MS BCK FWD MSD STK PFX VNT> 

<ENTRY SPAN SFL LSP AUT TLS BST FDF WDS> 

<ENTRY ELT MTYP MCNF STYP SCNF MDUR SDUR> 

<ENTRY DOF CNFSUM FRDSUM NMELTS ETOL LTOW WTOL LTOE ETOW WTOE SPCERR MRKERR MKCHNG MRKCOR MRKPOS> 

\ 

"MCOD -- the morse code data vector.  each element is a mark-space
data vector." 

<NEWTYPE MCOD UVECTOR '<<PRIMTYPE UVECTOR> [REST MS]>> 

"ELT -- the actual duration and confidence data for a mark-space
pair.  contains the confidence of the mark, the type of space, its
confidence, and the actual durations of the mark and space" 

<BUILD-TEMPLATE ELT #WORD *201100000006* 6 ![17859346471 17197694972 24150802432 17859346434 -24678236162 24150802432 17859346471 17197694973 24150802432 17859346434 -24141365250 24150802432 17859346434 -24678236161 24150802432 17859346434 -24141365249 24150802432 23748153400 23748153403 23748153406 23748153409 23748153412 23748153415!] ![12490641526 26046627879 24150802432 17466130428 31142445056 24150802432 12490641526 26046627842 24150802432 -25483542530 31142445056 24150802432 12490641526 26046627879 24150802432 17466130429 31142445056 24150802432 12490641526 26046627842 24150802432 -20651704322 31142445056 24150802432 12490641526 26046627842 24150802432 -25483542529 31142445056 24150802432 12490641526 26046627842 24150802432 -20651704321 31142445056 24150802432 19562233857 23748153426 23748153432 23748153438 23748153444 23748153450 23748153456!] (() 4152 (54) (18 19 20 21 22 23)) (() 4178 (54) (37 38 39 40 41 42 30 24 18 12 6 0)) [((ATOM 36 0 1 36) (FLOAT 18 0 3 36) (ATOM 36 0 2 36) (FLOAT 18 0 3 18) (FLOAT 18 0 4 36) (FLOAT 18 0 4 18)) () 6 0 #FALSE () 5 0] '<ELT ATOM FLOAT ATOM FLOAT FLOAT FLOAT [REST <NOT ANY>]>> 

<BUILD-TEMPLATE MS #WORD *201100000006* 6 ![17859346443 -19846397955 24150802432 17859346443 -20383268867 24150802432 17859346522 -19846397954 24150802432 17197694975 -16760438528 23085453454 17859346449 17330864128 24150802432 17859346471 17198482459 24150802432 17859346433 12499030167 24150802432 17859346443 -20383268866 24150802432 29143072767 23748153471 23748153474 23748153477 23748153480 23748153489 23748153492!] ![12490641609 26046627851 24150802432 -24946671619 31142445056 24150802432 12490641609 26046627851 24150802432 -21188575235 31142445056 24150802432 12490641609 26046627930 24150802432 -24946671618 31142445056 24150802432 17197694975 12490641609 26583498769 23085453496 -10586423040 23085453497 -14881390336 17466130431 31142445056 24150802432 12490641609 26046627841 24150802432 12767465672 31142445056 24150802432 12490641609 26046627851 24150802432 -21188575234 31142445056 24150802432 29143072767 19562233857 23748153504 23748153510 23748153516 23748153522 23748153532 23748153538!] (((ELT TEMPLATE) 90 (6)) 4223 (54 TVTOFF!-ITEMPLATE!-RPACKAGE 1051 (17)) (25 26 27 28 11 29 30 19)) (((ELT TEMPLATE) 90 (13)) 4256 (54) (42 43 44 45 21 23 46 47 34 28 19 12 6 0 31)) [((LIST 18 0 1 36) (LIST 18 0 1 18) (ELT 18 0 2 36) (BOOLEAN 1 0 3 27) (FIX 9 0 3 36) (LIST 18 0 2 18)) () 6 0 #FALSE () 4 0] '<MS <LIST [REST SPAN]> <LIST [REST SPAN]> ELT <OR ATOM FALSE> FIX <LIST [REST EVNT]>>> 

<BUILD-TEMPLATE DOF #WORD *201100000016* 14 ![17859346434 -24678236163 24150802432 17859346434 -24141365251 24150802432 17859346433 12499030289 24150802432 17859346433 12499030288 24150802432 17859346433 12499030287 24150802432 17859346433 12499030286 24150802432 17859346433 12499030285 24150802432 17859346433 12499030284 24150802432 17859346433 12499030283 24150802432 17197694975 -16760438780 23085453555 17859346449 17330864128 24150802432 17859346471 17198482459 24150802432 17197694975 -16760438782 23085453564 17859346449 17330864128 24150802432 17859346471 17198482459 24150802432 17859346433 12499030282 24150802432 17859346433 12499030281 24150802432 17859346433 12499030280 24150802432 21610102782 29059186687 33370931199 22599958527 25821183999 84934654 5453643774 10822352894 16191062014 30200037374 23748153554 23748153557 23748153560 23748153563 23748153566 23748153569 23748153572 23748153575 23748153578 23748153581 23748153590 23748153599 23748153602 23748153605!] ![12490641800 26046627842 24150802432 -25483542531 31142445056 24150802432 12490641800 26046627842 24150802432 -20651704323 31142445056 24150802432 12490641800 26046627841 24150802432 12767465863 31142445056 24150802432 12490641800 26046627841 24150802432 12767465862 31142445056 24150802432 12490641800 26046627841 24150802432 12767465861 31142445056 24150802432 12490641800 26046627841 24150802432 12767465860 31142445056 24150802432 12490641800 26046627841 24150802432 12767465859 31142445056 24150802432 12490641800 26046627841 24150802432 12767465858 31142445056 24150802432 12490641800 26046627841 24150802432 12767465857 31142445056 24150802432 17197694975 12490641800 26583498769 23085453662 -10586423292 23085453663 -14881390588 17466130431 31142445056 24150802432 17197694975 12490641800 26583498769 23085453672 -10586423294 23085453673 -14881390590 17466130431 31142445056 24150802432 12490641800 26046627841 24150802432 12767465856 31142445056 24150802432 12490641800 26046627841 24150802432 12767465855 31142445056 24150802432 12490641800 26046627841 24150802432 12767465854 31142445056 24150802432 21610102782 29059186687 33370931199 22599958527 25821183999 84934654 5453643774 10822352894 16191062014 30200037374 19562233857 23748153634 23748153640 23748153646 23748153652 23748153658 23748153664 23748153670 23748153676 23748153682 23748153688 23748153698 23748153708 23748153714 23748153720!] (() 4306 (54 TVTOFF!-ITEMPLATE!-RPACKAGE 1051 (35 44)) (64 65 66 67 68 69 70 71 72 73 29 74 38 75 76 77 7 10 13 16 19 22 25 46 49 52)) (() 4386 (54) (103 104 105 106 107 108 109 110 111 112 57 59 113 67 69 114 115 116 86 80 74 65 55 48 42 36 30 24 18 12 6 0 15 21 27 33 39 45 51 77 83 89)) [((FLOAT 18 0 1 36) (FLOAT 18 0 1 18) (FIX 8 0 2 36) (FIX 5 0 2 20) (FIX 5 0 2 15) (FIX 5 0 2 10) (FIX 5 0 2 5) (FIX 3 0 3 27) (FIX 3 0 3 24) (BOOLEAN 1 0 3 21) (BOOLEAN 1 0 3 20) (FIX 5 0 3 36) (FIX 4 0 3 31) (FIX 8 0 2 28)) () 14 0 #FALSE () 4 0] '<DOF FLOAT FLOAT FIX FIX FIX FIX FIX FIX FIX ANY ANY FIX FIX FIX [REST <NOT ANY>]>> 

<BUILD-TEMPLATE SPAN #WORD *550103000000* 7 ![12482253253 25258098688 17197432835 -16894656448 23085453729 17859346449 17330864128 24150802432 17859346471 17198482459 24150802432 12482253253 25258098688 17859346433 12499030468 24150802432 12482253253 25258098688 17859346471 17197432834 24150802432 12482253253 25258098688 17859346443 -19846660093 24150802432 12482253253 25258098688 17859346433 12499030467 24150802432 12482253253 25258098688 17859346524 -19846660092 24150802432 12482253253 25258098688 17859346470 17197432837 -21465661436 24150802432 7550533635 9815457795 19613351937 23748153753 23748153764 23748153769 23748153774 23748153779 23748153784 23748153789!] ![12482253328 25258098688 17197432835 12490641935 26583498769 23085453783 -10720640960 23085453784 -15015608256 17465868291 31142445056 24150802432 12482253328 25258098688 12490641935 26046627841 24150802432 12767465998 31142445056 24150802432 12482253328 25258098688 12490641935 26046627879 24150802432 17465868290 31142445056 24150802432 12482253328 25258098688 12490641935 26046627851 24150802432 -24946933757 31142445056 24150802432 12482253328 25258098688 12490641935 26046627841 24150802432 12767465997 31142445056 24150802432 12482253328 25258098688 12490641935 26046627932 24150802432 -24946933756 31142445056 24150802432 12482253328 25258098688 -20367540223 12490641935 26046627878 24150802432 17465868293 -21172060156 31142445056 24150802432 7550533635 9815457795 19562233857 19613351937 23748153807 23748153819 23748153827 23748153835 23748153843 23748153851 23748153859!] (((DOF TEMPLATE) 92 (33)) 4505 (54 TVTOFF!-ITEMPLATE!-RPACKAGE 1051 (10)) (45 4 46 47 48 49 50 51 36 31 26 21 16 11 0 14 29)) (((DOF TEMPLATE) 92 (47)) 4559 (54) (66 5 7 67 68 69 70 71 72 52 44 36 28 20 12 0 55 46 38 30 22 14 3 17 41)) [((BOOLEAN 1 0 2 7) (FIX 9 0 2 18) (ATOM 36 0 1 36) (LIST 18 0 2 36) (FIX 2 0 2 9) (DOF 18 0 3 36) (STRING 54 0 3 18)) () 7 0 T 3 0] '<OR <SPAN ANY FIX ATOM LIST FIX [REST <NOT ANY>]> <SPAN ANY FIX ATOM LIST FIX DOF [REST <NOT ANY>]> <SPAN ANY FIX ATOM LIST FIX DOF STRING [REST <NOT ANY>]>>> 

<SETG ELT         ,6  ,6  .h 4"h  ,h + /Zx   "  + h   <w,T(,6   ,6   &   _y _z D   _z _{PD  _{ _| D   _| _}YD  _} _~PD  _~ _YD  X  _  /     p . @ Q@  Z  !#p /h + a,>  #`  0d+ h ,^  ,~   ,6p ,6p  BP+ h   p    |,          [0 ELT #DECL (ATOM FLOAT ATOM FLOAT FLOAT FLOAT) %<PRIMTYPE-C TEMPLATE> %<TYPE-C ELT TEMPLATE> TEMPLATE-TYPE-VIOLATION!-ERRORS]           B^8czh      DAd/P|`      E3ZxzE      CWDZ.wNx      CL$pap      > 

<AND <ASSIGNED? GLUE> .GLUE <PUT ,ELT GLUE ![352387072 0 -16961748028 0!]>> 

<SETG MS             ,6  ,6  .h 4"h  ,h + /Zx   "  + h   <w,T(,6   ,6   &   _y _zQD   _z _{XD   _{ _|QD   _| _}"h 1B  + h   h G@  _} _~dh  _~ _XD   X  _  /     p . @ Q@  Z  !#p /h + a,>  #`  0d+ h ,^  ,~   ,6p ,6p  BP+ h   p 6$     $8      CP          [0 MS #DECL (LIST LIST ELT ANY FIX LIST) %<PRIMTYPE-C MS> %<TYPE-C MS TEMPLATE> TEMPLATE-TYPE-VIOLATION!-ERRORS]           B^8czh      DAd/P|`      E3ZxzE      CWDZ.wNx      CL$pap      > 

<AND <ASSIGNED? GLUE> .GLUE <PUT ,MS GLUE ![352387072 282640 202178627 -16106127360!]>> 

<SETG DOF      3   ,6  ,6  .h 14"h  ,h + /Zx   "  + h   <w,T(,6   ,6   &   _q _rPD   _r _sYD   _s _tdh 1 _t _udh 0 _u _vdh 0 _v _wdh / _w _xdh / _x _ydh . _y _zdh . _z _{"h -1B  + h   h -G@  _{ _|"h -1B  + h   h ,G@  _| _}dh , _} _~dh + _~ _dh + X  _  /     p . @ Q@  Z  !#p /h *+ a,>  #`  0d+ h (,^  ,~   ,6p ,6p  BP+ h ( p (   6 >          $8   * 0    
      8      e&0          [0 DOF #DECL (FLOAT FLOAT FIX FIX FIX FIX FIX FIX FIX ANY ANY FIX FIX FIX) %<PRIMTYPE-C DOF> %<TYPE-C DOF TEMPLATE> TEMPLATE-TYPE-VIOLATION!-ERRORS]          B^8czh *     DAd/P|` %     E3ZxzE      CWDZ.wNx      CL$pap      > 

<AND <ASSIGNED? GLUE> .GLUE <PUT ,DOF GLUE ![352387072 17043521 1090801681 17248043200 -12880460800 0!]>> 

<SETG SPAN       3   ,6  ,6  .h 14"h  _
  "`  (
.*h ,(  +   h   h   h 	 *  + h 
 *  + h  *  + h ,6h 1,6h 1,6h 1,6h 1/Zx   "  1j  + h  "/}."h    + h         ,>    <w,T(,^  ,6   ,6     _  /   XJ   _x _y"h 01B  + h   h 0G@   _y _zdh / _z _{ D   _{ _|QD   _| _}dh //*  <*h $ _} _~QD <*h $ _~ _ D XB  X  _  /     p . @ Q@  Z  !#p /h .+ a,>  #`  0d+ h ,,^  ,~   ,6p ,6p  BP+ h ,     $       $8           Tt          [0 SPAN #DECL (ANY FIX ATOM LIST FIX "OPTIONAL" DOF STRING) %<PRIMTYPE-C SPAN> %<TYPE-C SPAN TEMPLATE> TEMPLATE-TYPE-VIOLATION!-ERRORS]        B^8czh .     DAd/P|` )     E3ZxzE      CWDZ.wNx      CL$pap      > 

<AND <ASSIGNED? GLUE> .GLUE <PUT ,SPAN GLUE ![335811857 5721100544 17665 278592 202178627 -16106127360 1310734 1572880 1835026!]>> 

<SETG MTYP 1> 

<SETG MCNF 2> 

<SETG STYP 3> 

<SETG SCNF 4> 

<SETG MDUR 5> 

<SETG SDUR 6> 

\ 

<MANIFEST MTYP MCNF STYP SCNF MDUR SDUR> 

"MS -- data vector for a mark-space pair.  contains the list of
spans which end at the space to the left of the mark, and the list
of the spans which begin at the space to the left of the mark.  it
also has the actual duration and confidence data (from FRAUD) and
a slot to stuff randomness into" 

<PUT MS DECL '<MS <LIST [REST SPAN]> <LIST [REST SPAN]> ELT <OR ATOM FALSE> FIX <LIST [REST EVNT]>>> 

<SETG BCK 1> 

<SETG FWD 2> 

<SETG MSD 3> 

<SETG STK 4> 

<SETG PFX 5> 

<SETG VNT 6> 

<MANIFEST BCK FWD MSD STK PFX VNT> 

"replacement for RND slot of MS" 

<DEFMAC RND ('X)
	<FORM PROG ((XX .X))
	      #DECL ((XX) MS)
	      '<COND (<STK .XX> <PFX .XX>)>>>

\ 

"DOF -- fraud degree of fit (goes into FDF slot of SPAN/NAPS
Contains: 
1/ number of times we have to change sense of a space
2/ number of times we have to change sense of a mark
3/ total sum of confidences assuming changes
4/ total sum of fraud confidences for the span
5/ number of ELTs involved
6/ number of illegal (i.e. LW-E or EL-W) space swaps

7/ correction applied to achieve decoding (only if mark-error)
8/ location of correction (only if mark-error)

Note that, when in a FDF slot as the real FRAUD decoding, elements
1, 2 and 6 will be 0, and 3 and 4 will be equal

" 

<SETG CNFSUM 1> 

<SETG FRDSUM 2> 

<SETG NMELTS 3> 

<SETG ETOL 4> 

<SETG LTOW 5> 

<SETG LTOE 6> 

<SETG WTOL 7> 

<SETG ETOW 8> 

<SETG WTOE 9> 

<SETG SPCERR 10> 

<SETG MRKERR 11> 

<SETG MKCHNG 12> 

<SETG MRKCOR 13> 

<SETG MRKPOS 14> 

<MANIFEST CNFSUM FRDSUM NMELTS ETOL LTOW LTOE WTOL WTOE ETOW MRKERR SPCERR MKCHNG MRKCOR MRKPOS> 

<DEFMAC ILLSPC ('X)
	<FORM PROG ((X .X))
	      #DECL ((X) DOF (VALUE) FIX)
	      '<+ <WTOE .X> <ETOW .X>>>>

<DEFMAC SPCHNG ('X)
	<FORM PROG ((X .X))
	      #DECL ((X) DOF (VALUE) FIX)
	      '<+ <ETOL .X> <LTOW .X> <LTOE .X> <WTOL .X>>>>

\ 

"SPAN  --  data about an interpretation of a section of
a morse code message.  contains the size of the span, who
caused it to be generated (or FALSE (reason) if it has no
winning interpretation as yet), and the words in it if it
has a winning interpretation.  There is also a slot for
the FRAUD confidence of the span" 

<SETG SFL 1> 

<SETG LSP 2> 

<SETG AUT 3> 

<SETG TLS 4> 

<SETG BST 5> 

<SETG FDF 6> 

<SETG WDS 7> 

<MANIFEST SFL LSP AUT TLS BST WDS FDF> 

"replacement for SRC slot of SPAN" 

<DEFMAC SRC ('X)
	<FORM PROG ((XX .X))
	      #DECL ((XX) SPAN)
	      '<COND (<SFL .XX> <AUT .XX>)
		     (ELSE <CHTYPE <TLS .XX> FALSE>)>>>

\ 

"EVNT -- Description of an event of interest that happened at this point in
time.  Examples would be speaker changes, changes in the signal, changes in
the type of code being sent, and so on." 

<NEWTYPE EVNT VECTOR '<VECTOR ATOM>> 

<SETG EVTYP 1> 

<MANIFEST EVTYP> 

\ 

<DEFMAC MREST ('X "OPTIONAL" ('N 1))
	<FORM CHTYPE <FORM REST .X .N> MCOD>>

<DEFMAC MBACK ('X "OPTIONAL" ('N 1))
	<FORM CHTYPE <FORM BACK .X .N> MCOD>>

<DEFMAC MTOP? ('C)
	<FORM PROG ((C .C))
	      #DECL ((C) MCOD)
	      '<==? <LENGTH .C> <LENGTH <TOP .C>>>>>

<ENDPACKAGE> 
