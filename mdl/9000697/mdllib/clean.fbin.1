'<PCODE "CLEAN">

<PACKAGE "CLEAN"> 

<ENTRY CLEANUP CLEAR-CLEANUP FLUSH-CLEANUP PRINT-CLEANUP> 

<ENTRY PURELST> 

<ENTRY PRINT-DECLS KEEP-DECLS USE-HASH> 

<ENTRY FLUSH-PKG-OBLS> 

<USE "PURITY"> 

<SETG KEEP-DECLS T> 

<SETG USE-HASH T> 

<NEWTYPE ASOTAB UVECTOR '<<PRIMTYPE UVECTOR> [REST LIST]>> 

<NEWTYPE HASH WORD> 

<SET GLUE T> 

<SETG PUREQ  %<RSUBR!- '[ %<PCODE!- "CLEAN" 0> PUREQ #DECL ("VALUE" <OR ATOM 
FALSE> ANY) L-UNUSE PUREQ T ![CLEAN!-PACKAGE ICLEAN PURITY!-PACKAGE IPURITY 
IPURIFY MUDDLE ERRORS INTERRUPTS PACKAGE RPACKAGE!] OBLIST MUDDLE SETG %<RGLOC 
SETG T> OUTCHAN "
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>Oblist ==> " (<LIST [REST OBLIST]>) GROUP-PURIFY 
KILL:PURITY "	Already-purified" "	Uniqued" "	Purified" "	G-Uniqued"
 "	Rsubr-Entry" "	Function" "	Pure-rsubr" "	Impure-Rsubr" BAD-RSUBR 
%<RGLOC PURELST T> %<RGLOC RSUBLST T> %<RGLOC PRSUBLST T> %<RGLOC RSUBENTLST T> 
%<RGLOC FCNLST T> %<RGLOC TYPLST T> %<RGLOC RETVCT T> RSUBR-ENTRY PGLUE GLUE 
"***GLOC USED***" STRING RSUBR CODE WORD %<RGLOC USE-HASH T> %<RGLOC DECLST T> 
%<RGLOC STRLST T> %<RGLOC FORMLST T> %<RGLOC VECTLST T> %<RGLOC GENLST T> LIST 
%<RGLOC KEEP-DECLS T> ("VALUE" "OPTIONAL" "TUPLE" "ARGS" "QUOTE") ![PURELST 
RSUBLST PRSUBLST RSUBENTLST FCNLST TYPLST!] CLEAN!-PACKAGE ICLEAN "CLEAN" 
"A total of " " oblists were examined,
containing a total of " " atoms.
Out of a total of " " rsubr's found, " "had their decl's uniquefied, and" 
"were added to the purification group.
" "There were " " atoms whose gdecl's were uniquefied.
" "
# of VALUES	TYPE" "	RSUBR-Impure" "	RSUBR-Pure" "	RSUBR-Entry" %<RGLOC 
DECL-TABLE T> ATOM "
************************ " "******************************" ("PMAP" "SDML" 
"VCTMAN" "CPYFIL") PACKAGE UNIQ.SIZE %<RGLOC UNIQ.TABLE T> %<TYPE-W ASOTAB 
UVECTOR> %<TYPE-W HASH WORD> ANY]>> 
<AND <ASSIGNED? GLUE> .GLUE <PUT ,PUREQ PGLUE ![738197503 -1 -1 -1 -268435456!]>
> 


<SETG DECL-TABLE '[DECL DECLST FORM FORMLST STRING STRLST VECTOR VECTLST ANY 
GENLST]> 

"Returns - VECTOR of FIXes
	1	# of OBLISTs encountered
	2	# of ATOMs checked
	3	# of DECLs unique'd
	4	# of GDECLs unique'd
	5	# of RSUBRs or RSUBR-ENTRYs in purification list
" 

<SETG CLEANUP %<RSUBR-ENTRY '[PUREQ CLEANUP #DECL ("VALUE" <VECTOR FIX FIX FIX 
FIX FIX [REST FIX]> "OPTIONAL" ANY ANY ANY ANY ANY ANY <LIST [REST OBLIST]>)] 16
>> 

<SETG CHK-FOR-PGLUE %<RSUBR-ENTRY '[PUREQ CHK-FOR-PGLUE #DECL ("VALUE" ANY <OR 
RSUBR RSUBR-ENTRY> ANY)] 1054>> 

<SETG CHK-FOR-GLOCS %<RSUBR-ENTRY '[PUREQ CHK-FOR-GLOCS #DECL ("VALUE" ANY ANY 
ANY "OPTIONAL" ANY)] 1161>> 

<SETG U-DECL %<RSUBR-ENTRY '[PUREQ U-DECL #DECL ("VALUE" ANY ANY)] 1297>> 

<SETG CLEAR-CLEANUP %<RSUBR-ENTRY '[PUREQ CLEAR-CLEANUP #DECL ("VALUE" <OR ATOM 
FALSE>)] 1617>> 

<SETG FLUSH-CLEANUP %<RSUBR-ENTRY '[PUREQ FLUSH-CLEANUP #DECL ("VALUE" <OR 
STRING <FALSE STRING [REST STRING]>>)] 1675>> 

<SETG PRINT-CLEANUP %<RSUBR-ENTRY '[PUREQ PRINT-CLEANUP #DECL ("VALUE" ATOM)] 
1778>> 

<SETG PRINT-DECLS %<RSUBR-ENTRY '[PUREQ PRINT-DECLS #DECL ("VALUE" <OR ATOM 
FALSE> "OPTIONAL" <OR <LIST [REST ATOM]> ATOM FALSE>)] 2098>> 

<SETG P-DECL %<RSUBR-ENTRY '[PUREQ P-DECL #DECL ("VALUE" <OR ATOM FALSE> ANY 
ATOM)] 2229>> 

<SETG FLUSH-PKG-OBLS %<RSUBR-ENTRY '[PUREQ FLUSH-PKG-OBLS #DECL ("VALUE" FIX 
"OPTIONAL" <LIST [REST STRING]>)] 2319>> 

<GDECL (UNIQ.TABLE) <<PRIMTYPE UVECTOR> [REST LIST]>> 

<SETG RGLOC-CHTYPE %<RSUBR-ENTRY '[PUREQ RGLOC-CHTYPE #DECL ("VALUE" <PRIMTYPE 
WORD> LOCR)] 2413>> 

<SETG HASHER %<RSUBR-ENTRY '[PUREQ HASHER #DECL (<OR <PRIMTYPE ATOM> <PRIMTYPE 
STRING>>)] 2423>> 

<SETG CREATE %<RSUBR-ENTRY '[PUREQ CREATE #DECL ("VALUE" <<PRIMTYPE UVECTOR> [
REST LIST]> FIX "OPTIONAL" ANY)] 2454>> 

<SETG AD-OBJECT %<RSUBR-ENTRY '[PUREQ AD-OBJECT #DECL ("VALUE" ANY ANY)] 2518>> 

<SETG HASH %<RSUBR-ENTRY '[PUREQ HASH #DECL ("VALUE" HASH ANY)] 2614>> 

<CLEAR-CLEANUP> 

<ENDPACKAGE> 
