<PACKAGE "M.HNG">

<ENTRY DIRHNG NEW-WORK>

<SETG DIRHNG-CHANNEL <>>

<GDECL (DIRHNG-CHANNEL) <OR FALSE CHANNEL>
       (DIRHNG-HANDLER) HANDLER>

<DEFINE DIRHNG (DIR "AUX" C H I)
	#DECL ((DIR) STRING (C) <OR FALSE CHANNEL> (H) <OR FALSE ATOM>
	       (I) <OR FALSE IHEADER>)
	<COND (<SET C
		    <OR ,DIRHNG-CHANNEL
			<SETG DIRHNG-CHANNEL
			      <OPEN "READ" ".FILE." "(DIR)" "DIRHNG" .DIR>>>>
	       <COND (<>
		      <GASSIGNED? DIRHNG-HANDLER>
		      <ON "CHAR" ,DIRHNG-HANDLER 4>)
		     (ELSE
		      <SETG DIRHNG-HANDLER
			    <COND (<AND <SET H <LOOKUP "CHAR" <INTERRUPTS>>>
					<SET I <GET .H INTERRUPT>>>
				   <HANDLER .I ,DIRHNGER>)
				  (ELSE
				   <ON "CHAR" ,DIRHNGER 4 <MAIN> .C>)>>)>)>>

<DEFINE DIRHNGER ("TUPLE" X)
	#DECL ((X) TUPLE)
	<SETG NEW-WORK T>
	<DISMISS T>>

<ENDPACKAGE>
