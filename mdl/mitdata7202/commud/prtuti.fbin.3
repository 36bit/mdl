'<PCODE "5PRTUT">

<PACKAGE "PRTUTI"> 

<ENTRY LINE-LNTH MONTHS P-ADDRL P-ADDR P-SPLIT P-SLIST P-TIME P-NOTES 
P-TEXT-SPLIT P-ENCLOSURES P-FORWARD P-AUTHOR-FORWARD P-FULNAM P-REPLIED-TO 
FROM-ITS? ITS-SITES NET-P-DATE NET-P-LINE NET-FROM DDT-ADRL DDT-ADR DDT-SPLIT 
MSG-FROM DDT-LIST DDT-FORWARD DDT-AUTHOR-FORWARD DDT-REPLIED-TO DDT-TEXT-LIST 
DDT-TEXT-SPLIT QUICK-DATE TOPS-20-DATE-TIME> 

<USE "M-DEFS" "M-DATA" "ITIME" "CHAN" "USRUTI" "HOSTS" "LSRTNS" "OPSYS"> 

<SETG MONTHS '["Jan" "Feb" "Mar" "Apr" "May" "Jun" "Jul" "Aug" "Sep" "Oct" "Nov"
"Dec"]> 

<SETG LINE-LNTH 65> 

<GDECL (LINE-LNTH) FIX (MONTHS) <VECTOR [REST STRING]>> 

\ 

"P-ADDRL -- print addressee list or single addressee" 

<SETG P-ADDRL  %<RSUBR!- '[ %<PCODE!- "5PRTUT" 0> P-ADDRL #DECL ("VALUE" <OR 
ATOM <LIST [REST <OR FALSE STRING> <OR FALSE STRING> STRING <OR FALSE STRING> <
OR FALSE STRING>]>> <OR ADDRESS <LIST [REST ADDRESS]>> CHANNEL "OPTIONAL" FIX) 
EXTRACT-HOST DATUM FIELD RCUSR LTIME INDENT-TO HOST HOME? T ", " "[For " "] " 
"; " %<RGLOC LINE-LNTH T> " at " " (" " " "??" %<RGLOC MONTHS T> " 	" 
"ITS-SITES" "]" " by " "by " "on " "
Forwarded-to: " " <[" "]." ">" OUTCHAN (CHANNEL) "----- Enclosure #" ":  " 
" -----" "READ" ":" ";" "IOC" "Cannot read file: " "19" "@" "Forwarded to: " 
"Forwarded by: " "Replied-to: " "-----"]>> 
<AND <ASSIGNED? GLUE> .GLUE <PUT ,P-ADDRL PGLUE ![715816960 0 0 0!]>> 


<SETG P-SPLIT %<RSUBR-ENTRY '[P-ADDRL P-SPLIT #DECL ("VALUE" ATOM <LIST [REST 
LIST]> CHANNEL)] 74>> 

"P-ADDR -- print single addressee" 

<SETG P-ADDR %<RSUBR-ENTRY '[P-ADDRL P-ADDR #DECL ("VALUE" <LIST [REST STRING <
OR FALSE STRING> <OR FALSE STRING> <OR FALSE STRING> <OR FALSE STRING>]> ADDRESS
CHANNEL "OPTIONAL" FIX)] 132>> 

"P-SLIST -- net header list of strings" 

<SETG P-SLIST %<RSUBR-ENTRY '[P-ADDRL P-SLIST #DECL ("VALUE" ATOM <LIST [REST 
STRING]> CHANNEL)] 286>> 

"P-TIME -- net header time fields" 

<SETG P-TIME %<RSUBR-ENTRY '[P-ADDRL P-TIME #DECL ("VALUE" STRING <OR FIX LIST 
UVECTOR> CHANNEL)] 352>> 

"NET-FROM -- net header FROM field" 

<SETG NET-FROM %<RSUBR-ENTRY '[P-ADDRL NET-FROM #DECL ("VALUE" <LIST [REST <OR 
FALSE STRING> <OR FALSE STRING> STRING <OR FALSE STRING> <OR FALSE STRING>]> 
ADDRESS CHANNEL)] 469>> 

"P-FULNAM -- print sender name in parens" 

<SETG P-FULNAM %<RSUBR-ENTRY '[P-ADDRL P-FULNAM #DECL ("VALUE" <OR ATOM 
CHARACTER FALSE> STRING CHANNEL "OPTIONAL" <OR STRING FALSE>)] 487>> 

"FROM-ITS? -- return site if its an ITS" 

<SETG FROM-ITS? %<RSUBR-ENTRY '[P-ADDRL FROM-ITS? #DECL ("VALUE" <OR FALSE FIX> 
STRING)] 665>> 

"P-NOTES -- print notes" 

<SETG P-NOTES %<RSUBR-ENTRY '[P-ADDRL P-NOTES #DECL ("VALUE" FALSE LIST CHANNEL)
] 711>> 

<SETG P-TEXT-SPLIT %<RSUBR-ENTRY '[P-ADDRL P-TEXT-SPLIT #DECL ("VALUE" ATOM <
LIST [REST LIST]> CHANNEL)] 753>> 

"P-FORWARD -- print a forwarding spec of (from (to) date)" 

<SETG P-FORWARD %<RSUBR-ENTRY '[P-ADDRL P-FORWARD #DECL ("VALUE" <OR FALSE 
STRING> LIST CHANNEL "OPTIONAL" <OR STRING FALSE>)] 812>> 

<SETG P-REPLIED-TO %<RSUBR-ENTRY '[P-ADDRL P-REPLIED-TO #DECL ("VALUE" STRING <
LIST FIX FIX> CHANNEL)] 955>> 

<SETG P-AUTHOR-FORWARD %<RSUBR-ENTRY '[P-ADDRL P-AUTHOR-FORWARD #DECL ("VALUE" 
ATOM <LIST [REST LIST]> CHANNEL)] 1005>> 

"P-ENCLOSURES -- print enclosures" 

<SETG P-ENCLOSURES %<RSUBR-ENTRY '[P-ADDRL P-ENCLOSURES #DECL ("VALUE" <OR ATOM 
FALSE> LIST CHANNEL)] 1063>> 

"NET-P-DATE -- net header date" 

<SETG NET-P-DATE %<RSUBR-ENTRY '[P-ADDRL NET-P-DATE #DECL ("VALUE" STRING <OR 
FIX LIST UVECTOR> CHANNEL)] 1281>> 

<SETG TOPS-20-DATE-TIME %<RSUBR-ENTRY '[P-ADDRL TOPS-20-DATE-TIME #DECL ("VALUE"
STRING <OR FIX LIST UVECTOR> CHANNEL)] 1396>> 

"NET-P-LINE -- print random text on a line" 

<SETG NET-P-LINE %<RSUBR-ENTRY '[P-ADDRL NET-P-LINE #DECL ("VALUE" ATOM STRING 
CHANNEL)] 1528>> 

\ 

"***** routines for simulating DDT/COMSAT style headers *****" 

"DDT-ADR -- single addressee, DDT-style" 

<SETG DDT-ADR %<RSUBR-ENTRY '[P-ADDRL DDT-ADR #DECL ("VALUE" <LIST [REST STRING 
<OR FALSE STRING> <OR FALSE STRING> <OR FALSE STRING> <OR FALSE STRING>]> 
ADDRESS CHANNEL "OPTIONAL" ANY FIX)] 1637>> 

"DDT-ADRL -- list of addressees, DDT-style" 

<SETG DDT-ADRL %<RSUBR-ENTRY '[P-ADDRL DDT-ADRL #DECL ("VALUE" <OR FALSE STRING>
<LIST [REST ADDRESS]> CHANNEL "OPTIONAL" <OR ATOM FALSE> FIX)] 1831>> 

<SETG DDT-SPLIT %<RSUBR-ENTRY '[P-ADDRL DDT-SPLIT #DECL ("VALUE" ATOM <LIST [
REST LIST]> CHANNEL "OPTIONAL" ANY)] 1915>> 

<SETG DDT-FORWARD %<RSUBR-ENTRY '[P-ADDRL DDT-FORWARD #DECL ("VALUE" <OR ATOM 
FALSE FIX> LIST CHANNEL)] 1986>> 

<SETG DDT-AUTHOR-FORWARD %<RSUBR-ENTRY '[P-ADDRL DDT-AUTHOR-FORWARD #DECL (
"VALUE" ATOM <LIST [REST LIST]> CHANNEL)] 2087>> 

<SETG DDT-REPLIED-TO %<RSUBR-ENTRY '[P-ADDRL DDT-REPLIED-TO #DECL ("VALUE" 
STRING <LIST FIX FIX> CHANNEL)] 2145>> 

"DDT-LIST -- like DDT-ADRL, but no hosts or locals" 

<SETG DDT-LIST %<RSUBR-ENTRY '[P-ADDRL DDT-LIST #DECL ("VALUE" <OR FALSE STRING>
<OR ADDRESS LIST> CHANNEL)] 2200>> 

"MSG-FROM -- like DDT-ADRL, but include all host names" 

<SETG MSG-FROM %<RSUBR-ENTRY '[P-ADDRL MSG-FROM #DECL ("VALUE" <LIST [REST 
STRING <OR FALSE STRING> <OR FALSE STRING> <OR FALSE STRING> <OR FALSE STRING>]>
ADDRESS CHANNEL)] 2219>> 

"DDT-TEXT-LIST -- print list of strings, guarantee on separate lines" 

<SETG DDT-TEXT-LIST %<RSUBR-ENTRY '[P-ADDRL DDT-TEXT-LIST #DECL ("VALUE" <OR 
FALSE STRING> LIST CHANNEL)] 2240>> 

<SETG DDT-TEXT-SPLIT %<RSUBR-ENTRY '[P-ADDRL DDT-TEXT-SPLIT #DECL ("VALUE" ATOM 
<LIST [REST LIST]> CHANNEL "OPTIONAL" <OR ATOM FALSE>)] 2296>> 

"QUICK-DATE -- print slashy dates" 

<SETG QUICK-DATE %<RSUBR-ENTRY '[P-ADDRL QUICK-DATE #DECL ("VALUE" FIX <OR FIX 
LIST UVECTOR> CHANNEL)] 2365>> 

"PN -- two-digit number printer, useful for slashy dates" 

<SETG PN %<RSUBR-ENTRY '[P-ADDRL PN #DECL ("VALUE" FIX FIX CHANNEL)] 2461>> 

<ENDPACKAGE> 
