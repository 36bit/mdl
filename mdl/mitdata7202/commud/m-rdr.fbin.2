'<PCODE "3M-RDR">

<PACKAGE "M-RDR"> 

<ENTRY READER-MAIL READER-DELIVERY READER-CITATION> 

<USE "M-DEFS" "FIELDS" "USRUTI" "M-TEMP" "M-READ" "R-DEFS" "MADMAN" "ASYLUM"> 

<SETG COMSYS-READER-ASYLUM <>> 

"READER-MAIL -- deliver citation to file READER.TXT on user's directory" 

<SETG READER-MAIL  %<RSUBR!- '[ %<PCODE!- "3M-RDR" 0> READER-MAIL #DECL ("VALUE"
<OR ATOM FALSE> ADDRESS) DRDA ITIME AFALSE TEMPRENAME MAIL-OPEN KEYGET DRDMSG %<
RGLOC MSG-SPACE T> %<TYPE-W SPACE VECTOR> "AUTHOR" "READER" "MSG-NO" "![" "]" T 
%<INTERNAL-RSUBR ASTRING 262143> "Author" "WHEN-ORIGINATED" "REMIND" %<RGLOC 
SCRATCH-SPACE T> "<" ">READER.ASYLUM" %<RGLOC COMSYS-READER-ASYLUM T> 
%<INTERNAL-RSUBR OPEN-DATA-FILE 2> %<INTERNAL-RSUBR AUVECTOR 262143> 
%<INTERNAL-RSUBR ARESET 1> %<INTERNAL-RSUBR DATA-AREAD 3> %<INTERNAL-RSUBR 
ARELEASE 2> %<INTERNAL-RSUBR DATA-APRINT 4> %<INTERNAL-RSUBR FLUSH-DATA-FILE 1> 
%<INTERNAL-RSUBR ACOPY 2> "PRINT" %<INTERNAL-RSUBR DATA-OPEN 3> 
%<INTERNAL-RSUBR DATA-CLOSE 2> "ABOUT-TO-CLOBBER" %<RGLOC MDB T> 
%<INTERNAL-RSUBR DATA-IPRINT 4> %<INTERNAL-RSUBR AVECTOR 262143>]>> 
<AND <ASSIGNED? GLUE> .GLUE <PUT ,READER-MAIL PGLUE ![715784192 0 0!]>> 


<SETG TIME-SENT %<RSUBR-ENTRY '[READER-MAIL TIME-SENT #DECL ("VALUE" ANY)] 122>> 

<SETG READER-FLAGS %<RSUBR-ENTRY '[READER-MAIL READER-FLAGS #DECL ("VALUE" FIX 
ADDRESS)] 158>> 

"READER-CITATION -- deliver citation to user's asylum" 

<SETG READER-CITATION %<RSUBR-ENTRY '[READER-MAIL READER-CITATION #DECL ("VALUE"
<OR ATOM FALSE> ADDRESS)] 202>> 

"READER-DELIVERY -- deliver citation and message to user's asylum" 

<SETG READER-DELIVERY %<RSUBR-ENTRY '[READER-MAIL READER-DELIVERY #DECL ("VALUE"
<OR ATOM FALSE> ADDRESS)] 377>> 

<SETG FIND-LOCAL %<RSUBR-ENTRY '[READER-MAIL FIND-LOCAL #DECL ("VALUE" <OR FALSE
FIX> FIX <VECTOR [REST FIX]>)] 745>> 

<ENDPACKAGE> 
