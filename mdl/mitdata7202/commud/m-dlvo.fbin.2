'<PCODE "3M-DLV">

<PACKAGE "M-DLVO"> 

<ENTRY LOGIN-MAIL READER-MAIL ONLINE-OUTPUT> 

<USE "MADMAN" "CHAN" "OPEN-APPEND" "FIELDS" "M-DEFS" "ITIME" "M-READ" "M-DAC" 
"M-DOUT" "M-DATA" "M-TEMP" "AP" "USRUTI" "M-TAI"> 

\ 

"LOGIN-MAIL -- login-file output" 

<SETG LOGIN-MAIL  %<RSUBR!- '[ %<PCODE!- "3M-DLV" 0> LOGIN-MAIL #DECL ("VALUE" <
OR ATOM FALSE> ADDRESS) OPEN-APPEND TEMPOPEN HSNAME DRDMSG TEMPDELETE TEMPCLOSE 
TEMPAPPEND DO-OUTPUT DO-APPLY DATUM AP? HOME? KEYGET DRDFLT AFALSE OK? DRD %<
RGLOC MSG-SPACE T> %<TYPE-W SPACE VECTOR> "LOGIN-MAIL" %<INTERNAL-RSUBR ASTRING 
262143> T "LOGIN-USERS" ["INSERT" "APPEND"] "INSERT" "RECEIVED-FROM-HOST" "MAIL"
 "AUTHOR" "READER" "MSG-NO" "REMIND" "Author" "ONLINE-OUTPUT" "ONLINE-USERS" 
"PRINT" "HACTRN" "CLI" SNM (STRING) NM1 NM2]>> 
<AND <ASSIGNED? GLUE> .GLUE <PUT ,LOGIN-MAIL PGLUE ![715827882 -25769803776 0!]>
> 


\ 

"READER-MAIL -- deliver mail to '<user> READER' file" 

<SETG READER-MAIL %<RSUBR-ENTRY '[LOGIN-MAIL READER-MAIL #DECL ("VALUE" <OR ATOM
FALSE> ADDRESS)] 484>> 

\ 

"ONLINE OUTPUT -- inform mail arrived via CLI:" 

<SETG ONLINE-OUTPUT %<RSUBR-ENTRY '[LOGIN-MAIL ONLINE-OUTPUT #DECL ("VALUE" <OR 
ATOM FALSE> ADDRESS "OPTIONAL" <OR FIX FALSE>)] 588>> 

\ 

"MAIL-OPEN -- open channel to mail file, either explicitly spec'ed
or the user's normal one in his directory.  If he has no directory,
then try the common; directory.  If INSERT? is false, try to append to
existing file, otherwise insert at beginning." 

<SETG MAIL-OPEN %<RSUBR-ENTRY '[LOGIN-MAIL MAIL-OPEN #DECL ("VALUE" <OR CHANNEL 
FALSE> STRING STRING "OPTIONAL" <OR STRING FALSE>)] 915>> 

<ENDPACKAGE> 
