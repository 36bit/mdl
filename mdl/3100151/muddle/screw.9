<SETG LOSLIST ()>

<SETG D <FUNCTION () <1? <MOD <RANDOM> 2>>>>

<SETG SCREW <FUNCTION FOO (N "AUX"  (M 0) G H) 
	<SET G (.N .M)> ;"SET UP A LIST"
	<COND (<D> <SETG LOSLIST (.G !,LOSLIST)>)> ; "MAYBE GROW LIST WITH SEGMENT"

	<SET G <VECTOR .M>> ;"MAKE A GARBAGE VECTOR"
	<COND (<D> <SETG LOSLIST (.G !,LOSLIST)>)> ;"AND MAYBE GROW AGAIN"

	<SET G <VECTOR .N>> ;"MAKE ANOTHER GARBAGE VECTOR"
	<COND (<D> <SETG LOSLIST (.G !,LOSLIST)>)> ;MAYBE
	<COND (<0? .N> <EXIT .FOO "WIN">)> ;"IF DONE N TIMES, LEAVE"
	<SET N <- .N 1>> ;"BUMP M AND CHOP N"
	<SET M <+ .M 1>>
	<COND (<EMPTY? ,LOSLIST> <AGAIN .FOO>)> ;"IF NO LOSLIST, GO AGAIN"
	<SET G <MOD <RANDOM> <LENGTH ,LOSLIST>>> ;"GET A NUMBER BETWEEN 0 AND LENGTH"

	<SET H <+ .G <MOD <RANDOM> <LENGTH ,LOSLIST>>>> ;"AND ANOTHER FOR WEIGHTED SUM"
	<COND (<L? .H <LENGTH ,LOSLIST>>)
	      (<SET H .G>)> ;"IF NOT INBOUNDS, USE FIRST"
	<RPLACD <REST ,LOSLIST .H> (<VECTOR <MOD <RANDOM> 5000>>) >
	<AGAIN .FOO>>>
