<RPACKAGE ÙQ ‘ì˘±Q>ÒCE<ãNTRY DATE RTIME RTIME:SEC GETTIMEZONE FIX-DATE>

%%<USE "JSYS">

<TITLE DATE>
	<DECLARE ("VALUE" <LIST FIX FIX FIX>)>
	<PUSHJ	P* IDATE>
	<JRST	FINIS>

<INTERNAL-ENTRY IDATE 0>
	<SUBM	M* (P)>
	<MOVNI	B* 1>
	<SETZ	D*>
	<ODCNV>
	<MOVE	A* C>
	<HLRZ	C* B>	;"YEAR"
	<IDIVI	C* 100>
	<PUSH	TP* <TYPE-WORD FIX>>
	<PUSH	TP* D>
	<HRRZS	B>	;"MONTH -- JAN=0"
	<ADDI	B* 1>
	<PUSH	TP* <TYPE-WORD FIX>>
	<PUSH	TP* B>
	<HLRZ	B* A>
	<ADDI	B* 1>
	<PUSH	TP* <TYPE-WORD FIX>>
	<PUSH	TP* B>
	<MOVEI	A* 3>
	<PUSHJ	P* IILIST>
	<JRST	MPOPJ>

<TITLE RTIME>
	<DECLARE ("VALUE" <LIST FIX FIX FIX>)>
	<PUSHJ	P* IRTIME>
	<JRST	FINIS>

<INTERNAL-ENTRY IRTIME 0>
	<SUBM	M* (P)>
	<MOVNI	B* 1>
	<SETZ	D*>
	<ODCNV>
	<HRRZ	A* D>
	<IDIVI	A* 3600>
	<PUSH	TP* <TYPE-WORD FIX>>
	<PUSH	TP* A>
	<IDIVI	B* 60>
	<PUSH	TP* <TYPE-WORD FIX>>
	<PUSH	TP* B>
	<PUSH	TP* <TYPE-WORD FIX>>
	<PUSH	TP* C>
	<MOVEI	A* 3>
	<PUSHJ	P* IILIST>
	<JRST	MPOPJ>

<TITLE RTIME:SEC>
	<DECLARE ("VALUE" FIX)>
	<PUSHJ	P* IRTIME:SEC>
	<JRST	FINIS>

<INTERNAL-ENTRY IRTIME:SEC 0>
	<SUBM	M* (P)>
	<MOVNI	B* 1>
	<SETZ	D*>
	<ODCNV>
	<HRRZ	B* D>
	<MOVE	A* <TYPE-WORD FIX>>
	<JRST	MPOPJ>

<TITLE GETTIMEZONE>
	<DECLARE ("VALUE" STRING)>
	<PUSHJ	P* IGETTIMEZONE>
	<JRST	FINIS>

<INTERNAL-ENTRY IGETTIMEZONE 0>
	<SUBM	M* (P)>
	<MOVNI	B* 1>
	<SETZ	D*>
	<ODCNV>
	<MOVE	A* <MQUOTE "EST"> -1>
	<MOVE	B* <MQUOTE "EST">>
	<TLNE	D* *200000*>	;"not daylight savings?"
	 <MOVE	B* <MQUOTE "EDT">>
	<JRST	MPOPJ>


;"RETURNS FIX OF FORM YYMMDD, TIMFCN USES THIS AS A BASIS FOR SOME REASON"

<TITLE FIX-DATE>
	<DECLARE ("VALUE" FIX)>
	<PUSHJ	P* IFIX-DATE>
	<JRST	FINIS>

<INTERNAL-ENTRY IFIX-DATE 0>
	<SUBM	M* (P)>
	<MOVNI	B* 1>
	<SETZ	D*>
	<ODCNV>
	<MOVE	A* C>
	<HLRZ	C* B>	;"YEAR"
	<IDIVI	C* 100>
	<IMULI	D* 10000>
	<HRRZS	B>	;"MONTH -- JAN=0"
	<ADDI	B* 1>
	<IMULI	B* 100>
	<ADD	D* B>
	<HLRZ	B* A>
	<ADDI	B* 1>
	<ADD	B* D>
	<MOVE	A* <TYPE-WORD FIX>>
	<JRST	MPOPJ>

<END>

<ENDPACKAGE>